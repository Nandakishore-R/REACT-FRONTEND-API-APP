@using DigitalCockpit.Web.Resources
@using DigitalCockpit.Web.ViewModel
@using DigitalCockpit.Common
@using DigitalCockpit.Common.Resources
@using DigitalCockpit.Web.Utils
@using DigitalCockpit.Web.Utils.RazorExtensions
@model DigitalCockpit.Web.ViewModel.ActionCentreViewModel
@{
    ViewBag.ActiveTab = "ActionCentre";
    ViewBag.Title = Resources_Messages.Label_ActionCenterTasks;
    Layout = "~/Views/Shared/_NewThemeLayouttwo.cshtml";
}
@{
    string permissionMask;
    string moduleMask;
    SessionManager.TryGet(StateManagement.SessionManagement.PermissionMask, out permissionMask);
    var effectivePermission = (PermissionMask)Enum.Parse(typeof(PermissionMask), permissionMask);

    SessionManager.TryGet(StateManagement.SessionManagement.ModuleMask, out moduleMask);
    var licensedModules = (ModuleMask)Enum.Parse(typeof(ModuleMask), moduleMask);
}

@section Styles
{
    <link href='https://cdn.datatables.net/1.10.13/css/dataTables.bootstrap.min.css' rel="stylesheet" />
    <link href='@Url.Content("~/Styles/new-design/components/containers.css")' rel="stylesheet" />
    <link href='@Url.Content("~/Styles/new-design/components/base-table.css")' rel="stylesheet" />
    <link rel="stylesheet" href='@Url.Content("~/Styles/new-design/components/edit-form.css")' />
    <link rel="stylesheet" href="~/Views/ActionCentre/ManageV2.css" />
    <link rel="stylesheet" media="print" href="~/Views/ActionCentre/ManageV2Print.css" />
    <link rel="stylesheet" href="~/Styles/app/MembershipPage.css" />
    <link rel="stylesheet" href="~/Views/Workflow/Memberships.css" />
    <link rel="stylesheet" href="~/Styles/SharedComponentsStyle/sharedcomponents_style.css" />
    <link href="~/Styles/libraries/antd.css" rel="stylesheet" />
    <link href="~/Styles/EntityHierarchyStyle/entityhierarchy_style.css" rel="stylesheet" />
    <link href="~/Styles/BSC_style/bsc_style.css" rel="stylesheet" />
    <link href="~/Styles/app/RiskFrequencyPattern.css" rel="stylesheet" />
    <link href="~/Styles/SearchSort/SearchSort_style.css" rel="stylesheet" />
    <link rel="stylesheet" href="~/Styles/SharedComponentsStyle/StageList.css" />

}

@section Header {
    <div class="action-centre-nav">
        <ul class="nav nav-tabs action-tabs">
            <li class="active">
                <a id="dueId" class="" data-toggle="tab" href="#DueTable"><span class="tab-num"></span><br />@Resources_Messages.Label_Due</a>
            </li>
            <li>
                <a id="overdueId" class="" data-toggle="tab" href="#OverdueTable"><span class="tab-num"></span><br />@Resources_Messages.Label_Overdue</a>
            </li>
            <li>
                <a id="upcomingId" class="" data-toggle="tab" href="#Upcoming"><span class="tab-num"></span><br />@Resources_Messages.Label_Upcoming</a>
            </li>
            <li>
                <a id="inprogressId" class="" data-toggle="tab" href="#Inprogress"><span class="tab-num"></span><br />@Resources_Messages.Label_InProgress</a>
            </li>
            <li>
                <a id="completedId" class="" data-toggle="tab" href="#Completed"><span class="tab-num"></span><br />@Resources_Messages.Label_Completed</a>
            </li>
            @*<li>
                <a id="draftId" class="" data-toggle="tab" href="#Draft"><span class="tab-num"></span><br />@Resources_Messages.Label_Draft</a>
            </li>*@
        </ul>

    </div>
}

@section Center {


    <link rel="stylesheet" href="~/Scripts/lib/FormRender/react-select.css">
    <link rel="stylesheet" href="~/Scripts/lib/FormRender/react-layout.css">

    <link rel="stylesheet" href="~/Scripts/lib/pageBreak/pageBreak.css">
    <link rel="stylesheet" href="~/Styles/app/SidePanels.css" />
    <link href='@Url.Content("~/Styles/newtheme/components/button.css")' rel="stylesheet" />

    <style type="text/css">

        .dataTables_scrollHeadInner {
            width: 100% !important;
        }

        @*remediation css*@
        .stage-form-edit {
            filter: invert(100%) sepia(32%) saturate(544%) hue-rotate(222deg) brightness(111%) contrast(100%);
        }

@*form-builder css*@
        #formDesignerAreaStage .LayoutPagesScroller div {
            line-height: 1.5em !important;
        }
        .menu-item {
            display: none;
        }
        #formDesignerAreaStage .tab-base-btn{
            font-size:1rem !important;
        }
        #formDesignerAreaStage .tab-conditional-btn {
            font-size: 1rem !important;
        }
        #formDesignerAreaStage .close-field {
            font-size: 1rem !important;
            line-height:4.5vh;
        }
        #formDesignerAreaStage .tab-elements {
            height: 4.5rem ;
        }
        .remediation-form > .form-wrap > .stage-wrap {
            width: 98% !important;
            height: 66vh;
            overflow-y: auto;
        }
        .remediation-form > .form-wrap > .stage-wrap > .form-field > .field-actions > .del-button {
            display: none !important;
        }
        .remediation-form .LayoutPagesScroller div {
            pointer-events: visible !important;
        }
        #formDesignerAreaStage > .form-wrap > .stage-wrap > .form-field > .field-actions > .del-button {
            display: none !important;
        }
        #formDesignerAreaStage > .form-wrap > .stage-wrap > .form-field > .field-actions > .copy-button {
            display: none !important;
        }

        #formDesignerAreaStage .LayoutPagesScroller div {
            pointer-events: visible !important;
        }
        #formDesignerAreaStage > .form-wrap > .stage-wrap > .page-field > .prev-holder > .fb-page {
            height: 81vh !important;
            overflow-y: auto !important;
            padding: 0 !important;
            background: #eee !important;
        }

        #formDesignerAreaStage > .form-wrap > .stage-wrap > .page-field > .prev-holder > .fb-page > .LayoutPage > .LayoutPageBody > .LayoutPages > .LayoutPagesScroller {
            font-size: 2vh;
        }

            #formDesignerAreaStage > .form-wrap > .cb-wrap > .frmb-control > li {
                font-size: 1rem !important;
                line-height: 1rem !important;
            }

        #formDesignerAreaStage > .form-wrap > .stage-wrap > .page-field > .prev-holder > .fb-page > .LayoutPage > .LayoutPageBody > .LayoutPageThumbnails > .PageIcons{
            display:none !important;
        }
        #formDesignerAreaStage {
            padding: 0 2rem;
            height: 81vh !important;
            overflow-y: hidden !important;
        }

        #formBuilder-stages {
            margin-left: -1.65vw !important;
            overflow-x: hidden !important;
            overflow-y: hidden !important;
            position: absolute;
            top: 0;
            background: white;
            width: 100%;
            height: 92% !important;
        }

        @*form-builder css end*@

        .r-navcrossRem {
            border: none;
            font-size: 10px;
            color: red;
            background-color: transparent;
        }
        .ajax-loader {
            visibility: hidden;
            background-color: rgba(255,255,255,0.7);
            position: absolute;
            z-index: +1000 !important;
            width: 100%;
            height: 100%;
        }

            .ajax-loader img {
                position: relative;
                top: 50%;
                left: 50%;
            }
        .r-navbar-crossimgRem {
            height: 3vh;
            position: absolute;
            top: -1vh;
            left: 1vw;
        }

        .selectnavbar-finish {
            font-weight: bold;
            border: none;
            width: 16%;
            margin-left: 1vh;
            margin-top: 3vh;
            border-radius: 4px;
            font-size: 2vh;
            height: 4.6vh;
            margin-right: 0vw;
            background-color: #32CD32 !important;
            color: white;
        }
        .stageFlex{
            margin :-2.3rem 0rem !important;
        }
        div.ant-col.displayFlex > input {
            width: 49vw;
            border: none;
            border-bottom: 1px solid gray !important;
            background: transparent;
            margin-left: -12vw;
            margin-top: -1vh;
        }
        #formBuilder-stages{
            margin-left:-1vw;
        }
        div.stageBackground > div > div > div > div > div > div {
            background-color: #F2F3FA !important;
        }
        div.stageBackground > div > div > button {
            margin-top: 2vh;
        }
        div.stageBackground > div > div > div > div > div > div > div.ant-collapse-content.ant-collapse-content-active > div > div > div> div > div > label > span {
            font-weight: bold;
            color: black;
        }
        div.stageBackground > div > div > div > div > div > div > div.ant-collapse-content.ant-collapse-content-active > div > div > div > div > div > div > div > div > table > thead > tr > th {
            font-weight: bold;
            color: black;
        }
        .selectnavbar-finish:hover {
            border: none;
            margin-top: 3vh;
            width: 16%;
            margin-left: 1vh;
            margin-right: 0vw;
            border-radius: 4px;
            font-size: 2vh;
            height: 4.6vh;
            background-color: #32CD32 !important;
            color: white;
        }
            .selectnavbar-finish:focus {
                border: none;
                margin-top: 3vh;
                width: 16%;
                margin-left: 1vh;
                border-radius: 4px;
                font-size: 2vh;
                height: 4.6vh;
                margin-right: 0vw;
                background-color: #32CD32 !important;
                color: white;
            }
        .selectnavbar-fadebutton {
            margin-left: 1vw;
            padding-left: 1vh !important;
            padding-right: 1vh !important;
            border: none;
            font-weight: bold;
            font-size: 2vh;
            height: 4.6vh;
            margin-top: 3vh;
            border-radius: 4px;
            background-color: lightgray !important;
            color: white !important;
        }

            .selectnavbar-fadebutton:hover {
                margin-left: 1vw;
                padding-left: 1vh !important;
                padding-right: 1vh !important;
                border: none;
                font-weight: bold;
                font-size: 2vh;
                height: 4.6vh;
                margin-top: 3vh;
                border-radius: 4px;
                background-color: lightgray !important;
                color: white !important;
            }

            .selectnavbar-fadebutton:focus {
                margin-left: 1vw;
                padding-left: 1vh !important;
                padding-right: 1vh !important;
                border: none;
                font-weight: bold;
                font-size: 2vh;
                height: 4.6vh;
                margin-top: 3vh;
                border-radius: 4px;
                background-color: lightgray !important;
                color: white !important;
            }
        .selectnavbar-button {
            transform: rotate(0deg);
            margin-left: 1vw;
            padding-left: 1vh !important;
            padding-right: 1vh !important;
            border: none;
            font-weight: bold;
            font-size: 2vh;
            height: 4.6vh;
            margin-top: 3vh;
            border-radius: 4px;
            background-color: #4E4E4E !important;
            color: white !important;
        }
            .selectnavbar-button:hover {
                transform: rotate(0deg);
                margin-left: 1vw;
                padding-left: 1vh !important;
                padding-right: 1vh !important;
                border: none;
                font-weight: bold;
                font-size: 2vh;
                height: 4.6vh;
                margin-top: 3vh;
                border-radius: 4px;
                background-color: #4E4E4E !important;
                color: white !important;
            }
            .selectnavbar-button :focus {
                transform: rotate(0deg);
                margin-left: 1vw;
                padding-left: 1vh !important;
                padding-right: 1vh !important;
                border: none;
                font-weight: bold;
                font-size: 2vh;
                height: 4.6vh;
                margin-top: 3vh;
                border-radius: 4px;
                background-color: #4E4E4E !important;
                color: white !important;
            }

        .selectnavbar-button-cancel {
            border: none;
            font-weight: bold;
            margin-top: 3vh;
            border-radius: 4px;
            font-size: 2vh;
            height: 4.6vh;
            background-color: #4E4E4E !important;
            color: white;
        }
            .selectnavbar-button-cancel:hover {
                border: none;
                font-weight: bold;
                margin-top: 3vh;
                border-radius: 4px;
                font-size: 2vh;
                height: 4.6vh;
                background-color: #4E4E4E !important;
                color: white;
            }

            .selectnavbar-button-cancel:focus {
                border: none;
                font-weight: bold;
                margin-top: 3vh;
                border-radius: 3px;
                font-size: 2vh;
                height: 4.6vh;
                background-color: #4E4E4E !important;
                color: white;
            }
        .p-selectnavbar {
            color: #B9B9B9 !important;
            line-height: 0 !important;
            font-size: calc(17*(50vh + 23.5vw)/910);
            font-weight: bold !important;
            padding-bottom: 3vh !important;
            margin-left:0vw;
            margin-right:0vw;
            padding-left:0vw;
            padding-right:0vw;
        }
        .p-selectnavbar-clicked {
            line-height: 0 !important;
            font-size: calc(17*(50vh + 23.5vw)/910);
            font-weight: bold !important;
            border: none;
            border-bottom: 3px solid #4286EE;
            color: black !important;
            padding-bottom: 3vh !important;
            margin-left: 0vw;
            margin-right: 0vw;
            padding-left: 0vw;
            padding-right: 0vw;
        }
        .selectnavbar-div {
            width: 100% !important;
            margin-left: 1vw;
            display: flex;
        }
        #myModal{
            z-index:1000 !important;
        }

        .modal1 {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1000; /* Sit on top */
            padding-top: 10%; /* Location of the box */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgb(0,0,0); /* Fallback color */
            background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
        }
        .membershipAdd {
            width: 95%;
            border-radius: 8px;
            border: 3px solid #4286EE;
            height: 6vh;
            margin-left:4vh;
        }
        .rolemodalForRemediation {
            position: relative !important;
            z-index: 1000 !important;
        }
        .selection-navbar {
            height: 9vh;
            margin-top: 7vh;
            margin-left: 2.5vw;
            background-color: white;
        }
        .MainRem-div {
            background-color: white !important;
            height:100% !important;
        }
        .mainform-init {
            height: 17vh !important;
            background-color: white;
            border-radius: 5px !important;
            overflow-y: hidden;
            padding: 3vh 2vh 1vh 3vh;
        }
        #initiativeformid {
            margin-bottom: 1vh !important;
            padding-bottom: 1vh !important;
        }
        .r-checktext {
            font: normal normal bold 2.2vh Montserrat;
            color: #4E4E4E;
            opacity: 1;
        }
        .r-owner-dd > .ant-select-selector {
            border-radius: 5px !important;
            height: 6.3vh !important;
            margin-bottom: 1.1vh !important;
            padding-top: 1.1vh !important;
            font-size: 2vh !important;
            font-weight: lighter !important;
            background-color: #F2F3FA !important;
        }
        .r-form-name {
            border-radius: 5px;
            height: 6.3vh;
            margin-bottom: 1.1vh;
            font-size: 2vh;
            font-weight: lighter;
        }       
        @*end*@
        #root {
            width: 100%;
            background: #fff;
            height: 100%;
            position: absolute;
            bottom: 0;
            z-index: 2;
            display: none;
            overflow-y: scroll !important;
        }

        .bootstrap-datetimepicker-widget.dropdown-menu {
            height: 48vh !important;
            width: 20vw !important;
        }
        .new-design-theme .navigate-tabs-panel .nav > li > a {
            color: #B9B9B9 !important;
            font-size: calc(17*(50vh + 23.5vw)/910);
            font-weight: bold !important;
        }

        .nav > li > a {
            padding: 10px 15px !important;
        }

        .item p {
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 20px;
        }


/*        #InprogressList_Task_wrapper > div:nth-child(2) > div > div.dataTables_scroll > div.dataTables_scrollHead > div > table > thead > tr > th:last-child,
        #CompletedList_Task_wrapper > div:nth-child(2) > div > div.dataTables_scroll > div.dataTables_scrollHead > div > table > thead > tr > th:last-child,
        #OverdueList_Task_wrapper > div:nth-child(2) > div > div.dataTables_scroll > div.dataTables_scrollHead > div > table > thead > tr > th:last-child,
        #UpcomingList_Task_wrapper > div:nth-child(2) > div > div.dataTables_scroll > div.dataTables_scrollHead > div > table > thead > tr > th:last-child,
        #DueList_Task_wrapper > div:nth-child(2) > div > div.dataTables_scroll > div.dataTables_scrollHead > div > table > thead > tr > th:last-child {
            width: 135px !important
        }*/

        #DraftList_Task_wrapper > div:nth-child(2) > div > div.dataTables_scroll > div.dataTables_scrollHead > div > table > thead > tr > th:last-child {
            width: 165px !important;
        }

        #myModal #actionFormStages {
            justify-content: normal !important;
        }

        #myModal .navigate-tabs-panel .tabs-list {
            position: relative;
            @*margin-right: 30vw;*@
        }

    #amendment_history_button {
        background-color: #4D94FF;
        height: calc(40 * 100vh / 910);
        margin: 0 0 calc(13 * 100vw / 1920) calc(14 * 100vw / 1920);

    }
        .navbar-stageform {
            height: calc(70 * 100vh / 910);
            background-color: #2C2F48;
            color: #fff;
            padding: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        #amendment_history_popup .head_container {
            background-color: #4D94FF;
            border-radius: 10px 10px 0px 0px;
            padding: 16px;
            color: white;
            font-size:18px;
        }

        #amendment_history_popup .history_content {
            background: white;
            width: 50vw;
            margin: auto;
            height: 50vh;
            margin-top: 25vh;
            border-radius: 10px 10px 10px 10px;
        }

        #amendment_history_popup {
            background: rgba(0,0,0,0.7);
            height: 100vh;
            width: 100vw;
            display:none;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 10000;
        }

            #amendment_history_popup .history_data {
                background: #4D94FF;
                list-style: none;
                border-radius: 5px;
                margin: 10px;
                padding: 10px;
                margin-top: 10px;
            }

                #amendment_history_popup .history_data li {
                    color: white;
                    display: inline-block;
                    text-align: left;
                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                    padding-right: 15px
                }


            #amendment_history_popup .history_data li a{
                background: transparent;
                border: 2px solid white;
                border-radius: 38px;
            }


        .currencyBody .Select--single > .Select-control .Select-value {
            text-overflow: unset;
        }


        .currencyBody span.Select-arrow-zone > span {
            display: none;
        }


        .LayoutPagesScroller div {
            -ms-overflow-style: scrollbar;
            pointer-events: none;
        }

        .disabledTab {
            pointer-events:all;
            overflow:hidden !important;
        }


        .pageBreakMenu {
            z-index: 10000;
        }

        .pageBreakElementActive {
            box-shadow: 0 0 3px 0 #000;
        }

        .pageBreak {
            box-shadow: 0 4px 0 0 #333;
        }

        #formDesignerArea .form-wrap.form-builder .field-actions .btn {
            opacity: 1 !important;
            cursor: pointer !important;
            display: inline-block ;
            pointer-events: visible !important;
        }
        #formDesignerArea #toggleMainDiv{
            display:none;
            visibility:hidden;
        }
        #formDesignerAreaStage .form-wrap.form-builder .field-actions .btn {
            opacity: 1 !important;
            cursor: pointer !important;
            display: inline-block !important;
            pointer-events: visible !important;
        }

        #formDesignerAreaStage #toggleMainDiv {
            display: none;
            visibility: hidden;
        }
        /*    #formDesignerArea > div > div {
            display:none;
        }

        #formDesignerArea .frmb.stage-wrap.pull-left {
            width: 100%;
        }

        #formDesignerArea .delete-button {
            display: none;
        }

        #formDesignerArea .field-actions {
            display: none;
        }

        #formDesignerArea .LayoutPageThumbnails {
            pointer-events: all;
        }

        #formDesignerArea .LayoutPageHeader {
            display: none !important;
        }

        [id^=stageActions_] > div > div.actionSelect.checkbox {
            pointer-events: none;
        }*/
        /*[id^=stageActions_] > div > div > label[for^=Abort] {
            visibility: hidden !important;
            display: none !important;
        }*/
        #formDesignerArea {
            padding: 0 2rem;
        }
        #formDesignerArea > .page-field .form-field {
            background: #ffffff;
        }
        #formDesignerAreaStage {
            padding: 0 2rem;
        }
        #formDesignerAreaStage > .page-field .form-field {
            background: #ffffff;
        }

        #frmb-1671190423992-fld-1
        .LayoutPage {
            height:calc(100vh - 15vh);
        }

        .navigate-tabs-panel {
            height: 5vh !important;
            position: relative;
            top: 1px;
        }

        .currencyBody .Select-value {
            text-overflow:unset;
        }

        [id ^= "stageForm_"] span.select2.select2-container.select2-container--material {
            top:-10px;
        }


        #formDesignerArea .frmb.stage-wrap.pull-left {
            width: 100%;
        }

        .LayoutPagesScroller, .LayoutPages > div {
            -ms-overflow-style: scrollbar;
        }

        #stageWrapper > div > div.new-design-theme.workflow-stages-card {
            /*display: none;*/
        }

        label.mandatoryCheck_label {
            visibility: hidden !important;
        }

        #select2-referencecListRCSA-container {
            width: 100%;
        }


        #OverdueList_Task tbody tr.selectedRow,
        #InprogressList_Task tbody tr.selectedRow {
            background-color: #4D94FF !important;
            color: white;
        }


        tbody tr.selectedRow .submitFormButton {
            color: white;
            border-color: white;
        }

         tbody tr.selectedRow .reviewFormButton {
            color: white;
            border-color: white;
        }

        tbody tr.selectedRow .badge.cursor {
            color: #4D94FF;
            background-color: white !important;
        }

        tbody tr.selectedRow .SubmitApprovalHistory .appproval-history-icon button {
            background-color: white ;
            background: white ;
            color: #4D94FF ;
        }

      tbody tr.selectedRow  .ReviewApprovalHistory .appproval-history-icon button{
            background-color: white ;
            background: white ;
            color: #4D94FF ;

      }

        #OverdueList_Task tbody tr.selectedRow td,
        #InprogressList_Task tbody tr.selectedRow td {
            background: transparent;
        }



        #DueList_Task tbody tr.selectedRow {
            background-color: #4D94FF !important;
            color: white;
        }

            #DueList_Task tbody tr.selectedRow td {
                background: transparent;
            }





        #DraftList_Task tbody tr.selectedRow {
            background-color: #4D94FF !important;
            color: white;
        }

            #DraftList_Task tbody tr.selectedRow td {
                background: transparent;
            }




        #UpcomingList_Task tbody tr.selectedRow {
            background-color: #4D94FF !important;
            color: white;
        }

            #UpcomingList_Task tbody tr.selectedRow td {
                background: transparent;
            }



        #CompletedList_Task tbody tr.selectedRow {
            background-color: #4D94FF !important;
            color: white;
        }

            #CompletedList_Task tbody tr.selectedRow td {
                background: transparent;
            }






        /*.glyphicon-trash.delete {
                display: none !important;
                visibility: hidden !important;
            }*/




        #actionBody > div:nth-child(8) > span.select2.select2-container.select2-container--material > span.selection > span,
        #actionBody > div:nth-child(8) > span.select2.select2-container.select2-container--material.select2-container--focus > span.selection > span,
        #actionBody > div:nth-child(8) > span.select2.select2-container.select2-container--material.select2-container--below > span.selection > span {
            border: 0;
            background: #F2F3FA;
            text-indent: 1vw;
            border-radius: 0.5vw;
            padding: calc(24px * 100vh / 910) 1vw;
            padding: 3vh;
            position: relative;
            top: -3px;
        }

        #select2-referencecListRCSA-container {
            position: relative;
            top: -9px;
        }

        ::placeholder { /* Chrome, Firefox, Opera, Safari 10.1+ */
            color: #c9c4c4;
            opacity: 0.8; /* Firefox */
        }

        textarea:-moz-read-only { /* For Firefox */
            white-space: pre-line !important;
        }

        textarea:read-only {
            white-space: pre-line !important;
        }

        #formStagesModal > div {
            right: unset !important;
            left: 0;
        }

        #stage_container2 > div {
            height: 83.3vh;
            width: 100%;
            overflow-y: scroll;
            margin: 0px;
        }

        .base-table .dataTables_scrollBody {
            max-height: 62.5vh !important;
        }

        #stageWrapper > div > ul {
            background: transparent !important;
        }

        #DueList_Task_wrapper th.active, #OverdueList_Task_wrapper th.active, #UpcomingList_Task_wrapper th.active, #CompletedList_Task_wrapper th.active, #DraftList_Task_wrapper th.active {
            color: #4D94FF;
        }


        @*.new-design-theme div.sidebar {
            width: calc(85 * 100vw / 1920) !important;
            overflow: hidden;
        }*@


        .amendmentFeild {
            border: 0;
            border-bottom: 1px solid black;
            width: 100%;
        }

        .ReviewApprovalHistory .appproval-history-icon button {
            font-family: cursive;
        }

        .LayoutPageHeader {
            background: transparent !important;
        }

        #divAction .radio label input[type=radio]:checked ~ span.check {
            left: 4px;
            top: 6px;
            height: 14px;
            width: 14px;
        }

        [id^=stageForm_] > span > span.selection > span {
            background: transparent;
        }


        #stageWrapper > div > div.workflow-stages-card.supervisor {
            display: block;
            margin-bottom: 40px;
        }

        #supervisorApproval:before {
            height: calc(28 * 100vw / 1920);
            border: 1px solid black;
        }

        #approvalNotNeeded:before {
            height: calc(28 * 100vw / 1920);
            border: 1px solid black;
        }

        .edit-form .simple-check-box input[type=checkbox]:checked:after {
            top: calc(-1 * 100vh / 910) !important;
        }

        #stage_container {
            margin: 0px !important;
        }

            #stage_container > div {
                height: 83.3vh;
                width: 100%;
                overflow-y: scroll;
                margin: 0px;
            }

        #stageWrapper > div > ul {
            position: relative;
            top: 52px;
        }

        .nav-tab-container .incDecContainer {
            padding: calc(13 * 100vh / 910) 0;
            width: calc(130 * 100vw / 1920);
        }

        /*#stagedrag_1 {
            position: relative;
            top: -22vh;
        }*/

        #stageWrapper > div > div.new-design-theme.workflow-stages-card {
            position: relative;
            top: 33px;
        }

        body > div.main-panel.ps-container.ps-theme-default > div.main-container > div.nav-tab-container > div {
            padding: 0px 0px 32px 0px;
        }

        .togglebutton input:checked + label {
            position: absolute;
            right: 15px;
            top: 13px;
            background: #3974ce !important;
        }

        .togglebutton input + label {
            position: absolute;
            right: 15px;
            top: 13px;
        }
        #file1 {
            min-width: 18vw;
            margin: auto;
        }
        #main-div-import {
            display: flex;
            width: 25vw
        }

        #formStagesModal .modal-content {
            position: fixed;
            left: 0;
            top: 0;
            width: 100vw;
        }

        .fileInput {
            margin-top: 1%;
        }
        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 1%;
            border: 1px solid #888;
            width: 50%;
            height: 70%;
        }
        #btnAddtoFormStage {
            margin: 0;
            padding: 5px 10px;
            position: absolute;
            right: 0;
            top: 4px;
        }

            #formStagesModal > div > div > div.modal-header > div:nth-child(2) {
            position: absolute;
            right: 56px;
            top: 5px;
        }



        #stageWrapper > div > div.new-design-theme.workflow-stages-card > div {
            width: auto;
            margin-bottom: 20px;
            display: inline-block;
        }

        .number_stages {
            margin-right: 40px;
            color: rgba(0, 0, 0, 0.87);
        }

        .flex-row div[id^=stageActions] {
            width: 48% !important;
        }

        [id^=stageActions] > div > div > label {
            display: inline-block !important;
        }

        #minus {
            position: static;
        }

        .new-design-theme .workflow-stages-card.supervisor {
            display: block;
            padding-left: 15px;
        }


        .fix.fixed {
            color: lightgrey;
            top: 13px !important;
            transform: rotate(-46deg);
            -ms-transform: rotate(-46deg);
            -webkit-transform: rotate(-46deg);
            display: none !important;
        }


        .edit-form .simple-check-box .mandatoryCheck:before {
            width: 23px !important;
            height: 23px !important;
            left: 0px !important;
            top: -5px !important;
        }

        .opened .fix {
            color: black;
        }

        #divAction .radio label input[type=radio]:checked ~ span.check {
            left: 0.48465266558966075vh !important;
            top: 0.6462035541195477vh !important;
            height: 12px !important;
            width: 12px !important;
        }

        .opened .fix.fixed {
            color: lightgrey;
        }

        .fix {
            display: none !important;
            color: white;
            position: absolute !important;
            right: 63px !important;
            top: 18px !important;
            -webkit-transition: -webkit-transform .8s ease-in-out;
            -ms-transition: -ms-transform .8s ease-in-out;
            transition: transform .8s ease-in-out;
            transition: all 0.8s ease-in-out;
        }

        .list-item-header {
            position: relative;
        }

        .workflow-stages-container .edit-form .form-group > span {
            height: unset !important;
        }


        #pageSecondLast th, #pageThirdLast th {
            background-color: #4D94FF;
            color: white;
            padding: 1vw;
        }

        #pageSecondLast td, #pageThirdLast td {
            padding: 14px 0px;
            font-size: 12px;
            padding-left: 16px;
            border: 1px solid lightgrey;
        }

        .drop-div {
            height: auto;
            min-height: 5px;
            width: 100%;
            border: 0px;
            -webkit-transition: height 10s; /* Safari prior 6.1 */
            transition: height 10s;
        }

            .drop-div.drop-active {
                height: auto;
                min-height: 80px;
                margin: 5px 0px 13px 0px;
                border: 4px dashed lightgrey;
            }




        .opened .mandatoryCheck_label {
            color: black !important;
        }

        .opened .mandatoryCheck::after {
            top: -4px !important;
            left: 6px !important;
        }

        .tab-pane .table tbody > tr > td:first-child {
            width: unset;
        }

        #numberOfStages {
            border: 0px !important;
        }

        #plus {
            position: static !important;
        }



        .SubmitApprovalHistory .appproval-history-icon button {
            font-family: cursive;
        }



        td.details-control {
            background: url('../../Images/details_open.png') no-repeat center center;
            cursor: pointer;
        }

        .new-design-theme .radio label input[type=radio]:checked ~ span.check {
            left: 1.08%;
            top: 24%;
        }

        #radioGroups span.check {
            left: 13.08%;
        }

        #history_Div {
            height: auto !important;
        }


        .Grid td input {
            border: 0px !important;
        }

        tr.shown td.details-control {
            background: url('../../Images/details_close.png') no-repeat center center;
        }

        i.fa.fa-spinner.fa-spin.fa-3x.fa-fw {
            position: fixed !important;
            top: 50% !important;
            left:50% !important;
        }

        div.currencyBody > div.col-md-2.current-body > div > div > span.Select-arrow-zone > span {
            right: 11%;
        }
        #frmb-1674542078130-form-wrap{
            overflow-x:hidden !important;
        }

        div.currencyBody > div.col-md-2.current-body > div > div > span.Select-multi-value-wrapper > div.Select-value > .Select-value-label {
            right: 0.5vw;
            top: -0.4vh;
        }
        .save-stages-form {
            font-size: 2vh;
            font-weight: bold;
            background: #4caf50;
            border-radius: 3px;
            opacity: 1;
            color: white;
            position: absolute;
            border: none;
            top: -1.4vh;
            padding: 2%;
            min-width: 92%;
        }

            .save-stages-form:hover {
                background: #4caf50 !important;
                color: white !important;
            }

            div.currencyBody > div.col-md-2.current-body > div > div {
                height: 6vh;
            }

        .glyphicon.glyphicon-eye-open {
            position: absolute;
            top: 29px;
            right: 26px;
        }

        .loadingOverlay {
            width: 100vw;
            height: 100vh;
            position: fixed;
            top: 0px;
            left: 0px;
            background: rgba(225,225,225,0.3);
            z-index: 100;
        }

        .quickview-wrapper {
            box-shadow: none;
        }

        .ManageLeftPanel .checkbox {
            margin: 2vh auto;
        }

            .ManageLeftPanel .checkbox label {
                font-size: .8vw;
                padding: 0;
            }

        li.presentation.hidden {
            display: none;
        }

        .grey::before {
            color: lightgrey !important;
        }

        .LayoutPages {
            overflow-x: hidden;
        }

        #SaveCommentBtn {
            border: inherit;
            position: absolute;
            top: 50%;
            right: calc(44 * 100vw / 1920);
            -ms-transform: translateY(-50%);
            transform: translateY(-50%);
            width: calc(22 * 100vw / 1920);
            height: calc(16 * 100vh / 910);
            background-color: #FFF;
        }

            #SaveCommentBtn svg {
                width: calc(22 * 100vw / 1920);
                height: calc(16 * 100vh / 910);
            }


        .new-design-theme .panel-header .navbar > div.container-fluid .navbar-header {
            height: 40px !important;

        }
        #actionFormStages .action-form-stages-tooltip {
            top:-5px !important;
            margin-left:15px !important;

        }


        #approvalHistoryModal #stages-details .stages-remarks{
            height:auto !important;
        }

        /*#actionBody > div:nth-child(9){
            pointer-events:none !important;
        }

        #actionBody > div:nth-child(8){
             pointer-events:none !important;

        }*/
        .r-navbar1Form {
            position: fixed;
            top: 0vh;
            left: 4vw;
            width: 96% !important;
            height: 7% !important;
            background-color: #4286EE;
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
        }
        .r-data-modalForm {
            position: fixed;
            top: 7vh;
            left: 4vw;
            width: 96% !important;
            height: 93%;
            background-color: #F2F3FA;
            border-bottom-left-radius: 5px;
            border-bottom-right-radius: 5px;
            box-shadow: none !important;
            z-index: 0 !important;
            padding-top: 1vh;
            overflow-y: auto;
        }
        .policy-process > .select2-container--default > .selection > .select2-selection--multiple > .select2-selection__rendered {
            overflow-y: auto;
            height: 30px;
        }

        .textValuesPolicyProcess {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1%;
        }

            .textValuesPolicyProcess > p {
                text-overflow: ellipsis;
                overflow: hidden;
                display: -webkit-box;
                -webkit-box-orient: vertical;
                -webkit-line-clamp: 1;
                width: 50%;
            }

        .new-design-theme ul.leftside-nav {
            margin: 0;
            overflow: hidden;
        }
        .stageBackground {
            margin: 2rem;
            height: 74vh !important;
            overflow: auto;
        }

            @@media screen and (-ms-high-contrast: active), (-ms-high-contrast: none) {
  #UpcomingList_Task_wrapper > div:nth-child(2) > div > div.dataTables_scroll > div.dataTables_scrollHead > div > table > thead > tr > th:nth-child(7){
width:78px !important;
}

  #OverdueList_Task_wrapper > div:nth-child(2) > div > div.dataTables_scroll > div.dataTables_scrollHead > div > table > thead > tr > th:nth-child(7){
width:78px !important;
}

#DueList_Task_wrapper > div:nth-child(2) > div > div.dataTables_scroll > div.dataTables_scrollHead > div > table > thead > tr > th:nth-child(7){
width:78px !important;
}

    .control-panel{
        flex: 3 !important ;
    }

}

            #multiplestages > div > div{
width: calc(197 * 100vw / 1920) !important;
}

#multiplestages > label{
    color: #AAAAAA;
}

    .flexcontainer{
       display:flex;
       margin-top:5px;
   }
   .flexchild{
       flex:1;
   }
    @*Style to manage Radio Group and Color combination of the buttons in Action Center*@
        .new-design-theme .navigate-tabs-panel .action-tabs > li > a {
            color: #B9B9B9 !important;
            line-height: 1 !important;
            font-size: calc(17*(50vh + 23.5vw)/910);
            font-weight: bold !important;
            padding-bottom: calc(29 * 100vh / 910);
        }

        .new-design-theme .navigate-tabs-panel div.control-panel a.btn {
            border-radius: calc(5*(50vh + 23.5vw)/910);
            height: calc(40 * 100vh / 910);
            line-height: calc(40 * 100vh / 910);
            padding: 0 calc(16 * 100vw / 1920);
            margin: 0 0 calc(13 * 100vw / 1920) calc(14 * 100vw / 1920);
            font-size: calc(16*(50vh + 23.5vw)/910);
        }

        .radio input[type=radio][disabled] ~ .check {
            background-color: transparent !important;
        }
        .radio input[type=radio][checked] ~ .check {
           @* background-color: #4D94FF !important;*@
        }
        a.btn.btn-print {
            background-color: transparent !important;
        }

        @*Print Requires Height of the screen to rescale with*@
        .new-design-theme{
            height: auto !important;
        }
        #print-icon {
            padding: 0px !important;
        }
        #print-icon > i {
            font-size: 2.5vh !important;
            color: #4e4e4e !important;
            margin-right: 0.2vw !important;
        }
        #stageWrapper .stageMain ul {
            margin-inline-start: 0px;
            margin-inline-end: 0px;
            padding-inline-start: 40px
        }

        .select2-container--material .select2-selection .select2-selection__rendered {
            padding-left: 6px !important;
        }
        .noStagesAddedDiv {
            text-align: center;
            padding: 100px;
        }
        .Select--multi .Select-value-label {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 75vh;
        }

        .Select-value {
            padding-right: 5px !important;
        }
        .noStagesAddedDiv h2 {
            color: #BEC2D6
        }
        #amendment_history_popup .amendment_history_popup_scrollableDiv {
            overflow: auto;
            height: 39vh;
        }
        .close {
            display: inline-block;
        }
        .dataTables_scrollHeadInner {
            width: 100% !important;
        }

        .glyphicon-download-alt {
            color: #fff !important;
        }
        .material-confirmation-popup {
            font-size: 1.7rem !important;
            line-height: 0px !important;
        }
        .material-confirmation-container h2 {
            line-height: 40px !important;
            margin-top: -3vh;
        }
    </style>
    <link rel="stylesheet" href="~/Styles/app/percentage-scaling-actionCentre.css" />

    <svg style="display:none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 25 25">
        <symbol width="25" height="25" viewBox="0 0 25 25" id="action-open-sa" fill="#FFC35E">
            <g id="Group_5307" data-name="Group 5307" transform="translate(549.668 215.332)">
                <path id="Path_1409" data-name="Path 1409" d="M-418.739-159h-3.713v17.951a2.327,2.327,0,0,1-2.327,2.327h-9.554v.381a1.123,1.123,0,0,0,1.123,1.123h14.471a1.123,1.123,0,0,0,1.123-1.123v-19.535A1.123,1.123,0,0,0-418.739-159Z" transform="translate(-107.803 -53.115)" />
                <path id="Path_1410" data-name="Path 1410" d="M-533.073-215.333h-14.471a1.123,1.123,0,0,0-1.123,1.123v19.535a1.123,1.123,0,0,0,1.123,1.123h14.471a1.123,1.123,0,0,0,1.123-1.123V-214.21A1.123,1.123,0,0,0-533.073-215.333Zm-1.352,15.575a.876.876,0,0,1-.876.876h-10.015a.876.876,0,0,1-.876-.876h0a.876.876,0,0,1,.876-.876H-535.3a.876.876,0,0,1,.876.876Zm0-4a.876.876,0,0,1-.876.876h-10.015a.876.876,0,0,1-.876-.876h0a.876.876,0,0,1,.876-.876H-535.3a.876.876,0,0,1,.876.876Zm0-4a.876.876,0,0,1-.876.876h-10.015a.876.876,0,0,1-.876-.876h0a.876.876,0,0,1,.876-.876H-535.3a.876.876,0,0,1,.876.876Zm0-4a.876.876,0,0,1-.876.876h-10.015a.876.876,0,0,1-.876-.876h0a.876.876,0,0,1,.876-.876H-535.3a.876.876,0,0,1,.876.876Z" transform="translate(0 0)" />
            </g>
        </symbol>
    </svg>

    <svg style="display:none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 25 25">
        <symbol width="25" height="25" viewBox="0 0 25 25" id="action-delete-sa" fill="#FF525A">
            <g id="Action_Delete" clip-path="url(#clip-Action_Delete)">
                <g id="Group_4194" data-name="Group 4194" transform="translate(-42)">
                    <path id="BIN_1_" d="M0,3.879A1.27,1.27,0,0,1,1.293,2.586H7.759V1.293A1.27,1.27,0,0,1,9.052,0h2.586a1.27,1.27,0,0,1,1.293,1.293V2.586H19.4A1.27,1.27,0,0,1,20.69,3.879V5.172H0ZM19.4,7.759V23.707A1.27,1.27,0,0,1,18.1,25H2.586a1.27,1.27,0,0,1-1.293-1.293V6.466H19.4ZM6.466,10.345a1.293,1.293,0,0,0-2.586,0V21.121a1.293,1.293,0,1,0,2.586,0Zm5.172,0a1.293,1.293,0,0,0-2.586,0V21.121a1.293,1.293,0,1,0,2.586,0Zm5.172,0a1.293,1.293,0,1,0-2.586,0V21.121a1.293,1.293,0,1,0,2.586,0Z" transform="translate(45)" fill-rule="evenodd" />
                </g>
            </g>
        </symbol>
    </svg>

    @*@{ Html.RenderPartial("~/Views/Shared/FormStages.cshtml", false); }*@

    <div class="page-container">

        <div class="row">

            @*#AmendmentHistoryCode*@
            <div id="amendment_history_popup">
                <div class="history_content">
                    <div class="head_container">
                        <span onclick="closeAmendmentHistory()" style="cursor:pointer;">&#x2716;</span><strong style="padding-left:13px;">@Resources_Messages.Label_AmendmentHistory</strong>
                    </div><br />
                    <div class="amendment_history_popup_scrollableDiv">
                        <label id="amendment_popup_text" class="label-important" style="padding-left:35px;"></label>
                        <br />
                    </div>
                </div>

            </div>



            <div class="content ManageLeftPanel col-md-2">
                <div class="panel">
                    <div class="panel-heading header">
                        <label>@Resources_Messages.Label_Show</label>
                        <span class="fa fa-filter pull-right" style="color:white; font-size: 1vw;"></span>
                    </div>
                    <div class="panel-body" id="filterContainer">
                        <div class="checkbox p-l-15">
                            <input type="checkbox" name="optionsCheckboxes" value="" id="options-all" checked="checked">
                            <label for="options-all">
                                @Resources_Messages.Label_All
                            </label>
                        </div>
                        @foreach (var wft in Model.WorkFlowTypeViewModel)
                        {
                            <div class="checkbox p-l-15">
                                <input type="checkbox" name="optionsCheckboxes" value="@wft.Name" id="@wft.Name">
                                <label for="@wft.Name">
                                    @wft.Name
                                </label>
                            </div>
                        }
                    </div>
                </div>

            </div>

            <section class="content ManageTable col-md-10" id="actionsArea">

                <div style="position: relative;">

                    <div class="tab-content marginTop paddingLR paddingBottom10">
                        <div id="DueTable" class="tab-pane fade in active">
                            <div class="base-table">
                                <div @*class="card-content"*@>
                                    <div class="material-datatables">
                                        <table id="DueList_Task" class="table row-border order-column" style="width: 100% !important">
                                        </table>
                                        <div class="inner-tooltip"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="OverdueTable" class="tab-pane fade in">
                            <div class="base-table">
                                <div @*class="card-content"*@>
                                    <div class="material-datatables">
                                        <table id="OverdueList_Task" class="table row-border order-column" style="width: 100% !important">
                                        </table>
                                        <div class="inner-tooltip"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="Upcoming" class="tab-pane fade in">
                            <div class="base-table">
                                <div @*class="card-content"*@>
                                    <div class="material-datatables">
                                        <table id="UpcomingList_Task" class="table row-border order-column" style="width: 100% !important">
                                        </table>
                                        <div class="inner-tooltip"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="Inprogress" class="tab-pane fade in">
                            <div class="base-table">
                                <div @*class="card-content"*@>
                                    <div class="material-datatables">
                                        <table id="InprogressList_Task" class="table row-border order-column" style="width: 100% !important">
                                       
                                        </table>
                                        <div class="inner-tooltip"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="Completed" class="tab-pane fade in">
                            <div class="base-table">
                                <div @*class="card-content"*@>
                                    <div class="material-datatables">
                                        <table id="CompletedList_Task" class="table row-border order-column" style="width: 100% !important">
                                       
                                        </table>
                                        <div class="inner-tooltip"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="Draft" class="tab-pane fade in">
                            <div class="base-table">
                                <div @*class="card-content"*@>
                                    <div class="material-datatables">
                                        <table id="DraftList_Task" class="table row-border order-column" style="width: 100% !important">
                                       
                                        </table>
                                        <div class="inner-tooltip"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </section>

        </div>
    </div>

    <div id="myModal" class="quickview-wrapper fullWidth" style="margin-top: 8.2vh;">
        <div id="root">
        </div>
        <div class="LayoutPage" data-bind="with: gm.actioncentre.selectedRow()">
            <div class="LayoutPageHeader">































































                <!--<ul class="nav tabHead action-header">
                    <li class="col-md-4 pull-left text-left" style="font-size: 1.3em;">
                        <i class="fa fa-times quickview-toggle"
                           onclick="gm.actioncentre.closeRightPane(this)">
                        </i>
                    </li>
                    <li class="col-md-4 text-center">
                        <h4>ACTION STATUS</h4>
                    </li>
                    <li class="col-md-4 pull-right">
                        <div class="" id="btnActions">
                            <button type="button" class="btn btn-success pull-right" data-bind="click:gm.actioncentre.save" id="saveactions" tabindex="8">
                                @Resources_Messages.Label_Submit
                            </button>
                            <button type="button" class="btn btn-success pull-right" data-bind="click:gm.actioncentre.submit" id="submitactions" tabindex="8">
                                @Resources_Messages.Label_Submit
                            </button>
                            <button type="button" class="btn btn-success pull-right" data-bind="click:gm.actioncentre.saveReviewJson" id="btnSave" tabindex="8">
                                @Resources_Messages.Label_Save
                            </button>
                            <button type="button" class="btn btn-github pull-right m-r-10" tabindex="9" onclick="gm.actioncentre.closeRightPane(this)">
                                @Resources_Messages.Label_Cancel
                            </button>
                        </div>
                    </li>
                </ul>-->

                @Html.DC().Components.NavigationPanel(np =>
           {
               string cancelUrl = "gm.actioncentre.closeRightPane(this)";
               string printClick = "printForm()";
               string formClick = "gm.actioncentre.leftClick()";
               string reviewClick = "gm.actioncentre.rightClick()";
               string saveClick = "gm.actioncentre.saveReviewJson()";
               string submitClick = "gm.actioncentre.submit()";
               string addremidiation = "gm.actioncentre.addRemidiation()";

               np.Tabs.Add(np.Tab(@Resources_Messages.Label_Form, false, onClick: formClick));
               np.Tabs.Add(np.Tab(@Resources_Messages.Label_ReviewerAction, false, onClick: reviewClick));

               np.Actions.Add(np.Normal("ADD REMEDIATION", onClick: addremidiation, id: "remediationButton"));

               np.Actions.Add(np.Print(onClick: printClick, id: "print-icon"));

               np.Actions.Add(np.Normal(Resources_Admin.Button_Close, onClick: cancelUrl));

               np.Actions.Add(np.ArrowLeft(enabled: false, id: "btn_left"));

               np.Actions.Add(np.ArrowRight(enabled: false, id: "btn_right"));

               //np.Actions.Add(np.Change(Resources_Admin.Button_Save, onClick: saveClick, id: "saveActionCenterBtn"));

               np.Actions.Add(np.Submit(Resources_Admin.Button_Submit, onClick: submitClick, id: "submitActionCenterBtn"));

           })
                @*@{
                        Html.RenderPartial("~/Views/Shared/_NavigationPanel.cshtml",
                            new NavigationPanelModel(0)
                            .WithTab(new NavigationPanelTabModel(0, Resources_Messages.Label_Form))
                            .WithTab(new NavigationPanelTabModel(1, Resources_Messages.Label_ReviewerAction))
                                .WithAction(new NavigationPanelActionModel(NavigationPanelActionModel.ButtonType.PRINT, "")
                                    .WithAction("printForm()")
                                )
                                .WithAction(new NavigationPanelActionModel(NavigationPanelActionModel.ButtonType.NORMAL, Resources_Messages.Label_Close)
                                    .WithAction("gm.actioncentre.closeRightPane(this)")
                                )
                                .WithAction(new NavigationPanelActionModel(NavigationPanelActionModel.ButtonType.ARROW_LEFT)
                                    .Disabled(true)
                                )
                                .WithAction(new NavigationPanelActionModel(NavigationPanelActionModel.ButtonType.ARROW_RIGHT)
                                    .Disabled(true)
                                )
                                .WithAction(new NavigationPanelActionModel(NavigationPanelActionModel.ButtonType.NORMAL, Resources_Messages.Label_SaveandClose)
                                    .WithAction("gm.actioncentre.saveReviewJson()")
                                )
                                .WithAction(new NavigationPanelActionModel(NavigationPanelActionModel.ButtonType.SUBMIT, Resources_Messages.Label_Submit)
                                    .WithAction("gm.actioncentre.submit()")
                                )
                        );
                    }*@
            </div>
            <div class="LayoutPageBody">

                <div class="LayoutPageThumbnails">
                    <div>
                        <div id="thumbnailFirst" class="activeThumbnail"
                             onclick="gm.actioncentre.pageThumbnailClick(this, 'pageFirst');">
                            <span>1</span>
                        </div>
                        <div id="thumbnailThirdLast"
                             onclick="gm.actioncentre.pageThumbnailClick(this, 'pageThirdLast');">
                            <span>2</span>
                        </div>
                        <div id="thumbnailSecondLast"
                             onclick="gm.actioncentre.pageThumbnailClick(this, 'pageSecondLast');">
                            <span>3</span>
                        </div>
                        <div id="thumbnailLast"
                             onclick="gm.actioncentre.pageThumbnailClick(this, 'pageLast');">
                            <span>4</span>
                        </div>
                    </div>
                </div>
                <div class="LayoutPages">
                    <div>
                        <div id="pageFirst" class="fixedPage">
                            <div id="actionFormStages">
                                <div class="action-form-stages-container">
                                </div>
                                <div>
                                    <div class="all-stages-link" style="display: none;"
                                         data-bind="click:gm.actioncentre.viewApprovalHistory"
                                         id="actionFormShowStagesHistory" tabindex="8" data-show="true"
                                         @*data-text="@Resources_Admin.ActionCentre_HideApprovalHistory">*@>
                                        @Resources_Messages.Label_ViewAll
                                    </div>
                                </div>
                            </div>
                            @*<div class="modal-body action-history-table" id="actionFormApprovalHistory"
                                     style="display: none;">
                                    <div class="action-history-table-head-row">
                                        <div style="width: 13%">@Resources_Admin.ActionCentre_ApprovalHistoryDate</div>
                                        <div style="width: 13%">@Resources_Admin.ActionCentre_ApprovalHistoryUser</div>
                                        <div style="width: 15%">@Resources_Admin.ActionCentre_ApprovalHistoryStage</div>
                                        <div style="width: 13%">@Resources_Admin.ActionCentre_ApprovalHistoryAction</div>
                                        <div style="width: 46%">@Resources_Admin.ActionCentre_ApprovalHistoryRemarks</div>
                                    </div>
                                </div>*@
                            <div id="ActionValue" class="modal-body fixedPageContent">
                                <!-- Dynamic fields populated from API response -->
                            </div>
                            <div id="actionBody" class="modal-body fixedPageContent">
                                <div class="form-group NewActionValue">
                                    <label>
                                        @Resources_Messages.Label_Title
                                    </label>
                                    <input class="show amendmentFeild" id="titlefeild"
                                           data-bind="value:title" readonly />
                                    <div class="printTextBox" style="display: none;"
                                         data-bind="text:title"></div>
                                </div>
                                <!-- ko if: name() != null -->
                                <div class="form-group NewActionValue">
                                    <label>
                                        @Resources_Messages.Label_Name
                                    </label>
                                    <span class="show amendmentFeild" data-bind="text:name"></span>
                                    <div class="printTextBox" style="display: none;"
                                         data-bind="text:name"></div>
                                </div>
                                <!-- /ko -->
                                <!-- ko if: taskDescription() != null -->
                                <div class="form-group NewActionValue">
                                    <label>
                                        @Resources_Messages.Label_Description
                                    </label>
                                    <span class="show amendmentFeild" data-bind="text:taskDescription"></span>
                                    <div class="printTextBox" style="display: none;"
                                         data-bind="text:taskDescription"></div>
                                </div>
                                <!-- /ko -->
                                <div class="form-group NewActionValue">
                                    <label>
                                        @Resources_Messages.Label_ReferenceNumber
                                    </label>
                                    <span class="show amendmentFeild" data-bind="text:referenceNumber"></span>
                                    <div class="printTextBox" style="display: none;"
                                         data-bind="text:referenceNumber"></div>
                                </div>
                                <!-- ko if: personalID() != null -->
                                <div class="form-group NewActionValue">
                                    <label>
                                        URN
                                    </label>
                                    <span class="show amendmentFeild" data-bind="text:personalID"></span>
                                    <div class="printTextBox" style="display: none;"
                                         data-bind="text:personalID"></div>
                                </div>
                                <!-- /ko -->
                                <div class="form-group  item policy-process" id="policydiv" style="display:none">
                                    <label> Policy</label>
                                    <select id="policy" style="width:100%;"
                                            class="all-entities policy-process" data-placeholder="Select Policy" disabled>
                                        <option></option>
                                    </select>
                                    <div id="policy-text" class="form-group col-md-6">
                                    </div>
                                </div>

                                <div class="form-group item policy-process" id="clausediv" style="display:none">
                                    <label> Clauses</label>
                                    <select id="clauses" style="width:100%;"
                                            multiple class="all-entities policy-process" data-placeholder="Select Clauses" disabled>
                                    </select>

                                </div>

                                <div class="form-group item policy-process" id="processdiv" style="display:none">
                                    <label> Business Process</label>
                                    <select id="process" style="width:100%;"
                                            multiple class="all-entities policy-process" data-placeholder="Select Business Process" disabled>
                                    </select>
                                    <div id="process-text" class="form-group col-md-12"></div>
                                </div>
                                <div class="form-group item policy-process" id="controldiv" style="display:none">
                                    <label>Controls</label>
                                    <select id="control" name="control" style="width: 100%;" multiple class="control" data-placeholder="@Resources_Admin.PlaceHolder_SelectUser" disabled></select>
                                </div>
                                <div class="form-group item policy-process" id="riskdiv" style="display:none">
                                    <label>Risks</label>
                                    <select id="risk" name="risk" style="width: 100%;" multiple class="risk" data-placeholder="@Resources_Admin.PlaceHolder_SelectUser" disabled></select>
                                </div>
                                <!-- ko if: unitofMeasurement() != null -->
                                <div class="form-group">
                                    <label>
                                        Unit Of Measurement
                                    </label>
                                    <span class="show amendmentFeild" data-bind="text:unitofMeasurement"></span>
                                    <div class="printTextBox" style="display: none;"
                                         data-bind="text:unitofMeasurement"></div>
                                </div>
                                <!-- /ko -->
                                @*<div class="form-group hidden" id="originTaskDataArea">
                                        <label>
                                            Origin Task
                                        </label>
                                        <a class="show btn btn-info" href="#" style="width: 300px;"></a>
                                    </div>
                                    <div class="form-group hidden" id="amendmentTaskDataArea">
                                        <label>
                                            Amendment Task
                                        </label>
                                        <a class="show btn btn-info" href="#" style="width: 300px;"></a>
                                    </div>*@

                                <div class="form-group">
                                    <label id="selfAttestationLabel">
                                        @Resources_Messages.Label_SelfAttestation
                                    </label>
                                    <span class="show " id="selfAttestationPreview" data-bind="text:selfAttestationName"></span>
                                    <div class="printTextBox" style="display: none;"
                                         data-bind="text:selfAttestationName"></div>
                                </div>

                                <div class="form-group" id="divSelfAttestation">
                                    <label id="lblSelfAttestation">@Resources_Messages.Label_Certificate</label>
                                    <select id="selfAttestationList" name="selfAttestationList" style="width:100% !important;"
                                            class="form-control"></select>
                                </div>

                                <!-- ko if: controlName() != null -->
                                <div class="form-group">
                                    <label>
                                        @Resources_Messages.Label_ControlName
                                    </label>
                                    <span class="show" data-bind="text:controlName"></span>
                                    <div class="printTextBox" style="display: none;"
                                         data-bind="text:controlName"></div>
                                </div>
                                <!-- /ko -->
                                <!-- ko if: riskName() != null -->
                                <div class="form-group">
                                    <label>
                                        @Resources_Messages.Label_RiskName
                                    </label>
                                    <span class="show" data-bind="text:riskName"></span>
                                    <div class="printTextBox" style="display: none;"
                                         data-bind="text:riskName"></div>
                                </div>
                                <!-- /ko -->


                                <div id="riskdetails" class="initiator_detalis" style="border: 1px solid grey; border-radius:10px;margin:2vw;display:none">
                                    <br />
                                    <div class="form-group" style="width: 33%; margin: calc(10 * 100vh / 910) calc(32 * 100vw / 1920);">
                                        <label style="margin-bottom:5px;">
                                            @Resources_Messages.Label_RiskScore
                                        </label><br />
                                        <span id="riskscore"></span>
                                    </div>
                                    <div class="form-group" style="width: 33%; margin: calc(10 * 100vh / 910) calc(32 * 100vw / 1920);">
                                        <label style="margin-bottom:5px;">
                                            @Resources_Messages.Label_RiskInterpretation
                                        </label><br />
                                        <span id="riskinter"></span>
                                    </div><br />



                                </div>




                                <!-- ko if: controlDescription() != null -->
                                <div class="form-group">
                                    <label>
                                        @Resources_Messages.Label_ControlDescription
                                    </label>
                                    <span class="show" data-bind="text:controlDescription"></span>
                                    <div class="printTextBox" style="display: none;"
                                         data-bind="text:controlDescription"></div>
                                </div>
                                <!-- /ko -->
                                <!-- ko if: itSystemName() != null -->
                                <div class="form-group">
                                    <label>
                                        @Resources_Messages.Label_ITSystemName
                                    </label>
                                    <span class="show" data-bind="text:itSystemName"></span>
                                    <div class="printTextBox" style="display: none;"
                                         data-bind="text:itSystemName"></div>
                                </div>
                                <!-- /ko -->
                                <!-- ko if: workflowCategory() == 'RCSAW' -->
                                <div class="form-group" id="processName">
                                    <label>
                                        @Resources_Messages.Label_ProcessName
                                    </label>
                                    <select id="referencecListRCSA" name="referencecListRCSA"
                                            class="form-control"
                                            style="width: 100% !important;"></select>

                                </div>
                                <div class="modal-body form-group" id="viewprocessdetails">
                                    <a target="_blank" id="processUrl" href="#">@Resources_Messages.Label_ViewProcess</a>
                                    <br />
                                    <label>@Resources_Messages.Label_Status:</label>
                                    <label></label>

                                </div>


                                <!-- /ko -->
                                <!-- ko if: workflowCategory() == 'CRSA' -->
                                <div class="form-group" id="processName">
                                    <label>
                                        @Resources_Messages.Label_ProcessName
                                    </label>
                                    <select id="referencecListRCSA" name="referencecListRCSA"
                                            class="form-control"
                                            style="width: 100% !important;"></select>

                                </div>
                                <div class="modal-body form-group" id="viewprocessdetails">
                                    <a target="_blank" id="processUrl" href="#">@Resources_Messages.Label_ViewProcess</a>
                                    <br />
                                    <label>@Resources_Messages.Label_Status:</label>
                                    <label></label>

                                </div>


                                <!-- /ko -->
                                <!-- ko if: policyName() != null -->
                                <div class="form-group">
                                    <label>
                                        @Resources_Messages.Label_PolicyName
                                    </label>
                                    <span class="show" data-bind="text:policyName"></span>
                                    <div class="printTextBox" style="display: none;"
                                         data-bind="text:policyName"></div>
                                </div>

                                <!-- /ko -->
                                <!-- ko if: url() != null -->
                                <div class="form-group" id="processurlReadonly">
                                    <a data-bind="attr: { href: url() }" target="_blank" id="processurlRCSA">@Resources_Messages.Label_ViewProcessImage</a>
                                    <br />
                                    <label>@Resources_Messages.Label_Status:</label>
                                    <label data-bind="text: urlStatus"></label>
                                </div>
                                <!-- /ko -->

                                <div id="rejectProcessRCSA" class="form-group" style="display: none; visibility: hidden; ">
                                    <label>
                                        @Resources_Messages.Label_RejectProcess
                                    </label>
                                    <input type="checkbox" id="chkRejectProcess"
                                           style="vertical-align: top; margin-top: 5px;" />
                                    <div id="rejectProcessComment">
                                        <label>
                                            @Resources_Messages.Label_ProcessComment
                                        </label>
                                        <input id="rejectProcessCommentTb" placeholder="Enter Process Comment."
                                               type="text" class="form-control" />
                                    </div>
                                </div>

                                <div id="exceptionCountPreviewArea" class="material-datatables" style="display: none;">
                                    <div class="table-responsive">
                                        <table id="exceptionCountList" class="table table-striped table-no-bordered table-hover" style="width: 100% !important">
                                            <thead>
                                                <tr>
                                                    <th></th>
                                                    <th>@Resources_Messages.Label_Name</th>
                                                    <th style="position:relative; left:0px;">@Resources_Messages.Label_Type</th>
                                                    <th style="position: relative; right: 20px;">@Resources_Messages.Label_Open</th>
                                                    <th style="position: relative;right: 20px;">@Resources_Messages.Label_Closed</th>
                                                    <th style="position:relative; right:20px;">@Resources_Messages.Label_Total</th>
                                                </tr>
                                            </thead>
                                        </table>
                                    </div>
                                </div>

                                <div id="initiatorDetails" class="initiator_detalis" style="border: 1px solid grey; border-radius:10px;margin:2vw;">
                                    <br />
                                    <div class="form-group" style="width: 33%; margin: calc(10 * 100vh / 910) calc(32 * 100vw / 1920);">
                                        <label style="margin-bottom:5px;">
                                            @Resources_Messages.Label_Initiator
                                        </label><br />
                                        <span data-bind="text:initiatorName"></span>
                                    </div>
                                    <div class="form-group" style="width: 400px !important; margin: calc(10 * 100vh / 910) calc(32 * 100vw / 1920);">
                                        <label style="margin-bottom:5px;">
                                            @Resources_Messages.Label_InitiatedDate
                                        </label><br />
                                        <span data-bind="text:strDateOfRaise"></span>
                                    </div>

                                    @*<div class="form-group" style="width: 33%; margin: calc(10 * 100vh / 910) calc(32 * 100vw / 1920);">
                                            <label style="margin-bottom:5px;">
                                                @Resources_Messages.Label_Department
                                            </label><br />
                                            <span data-bind="text:initiatorDepartment"></span>
                                        </div>*@
                                    <div class="form-group" style="width: 200px !important; margin: calc(10 * 100vh / 910) calc(32 * 100vw / 1920);">
                                        <label style="margin-bottom:5px;">
                                            @Resources_Messages.Label_Role
                                        </label><br />
                                        <span data-bind="text:initiatorRole"></span>
                                    </div>
                                    @*<div class="form-group" style="width: 10%; margin: calc(20 * 100vh / 910) calc(32 * 100vw / 1920);">
                                            <label style="margin-bottom:5px;">
                                                @Resources_Messages.Label_Unit
                                            </label><br />
                                            <span data-bind="text:initiatorUnit"></span>

                                        </div>*@<br />
                                    <!-- ko if: kriRiskName() != null -->
                                    <div class="form-group" style="width: 33%; margin: calc(10 * 100vh / 910) calc(32 * 100vw / 1920);">
                                        <label style="margin-bottom:5px;">
                                            @Resources_Messages.Label_RiskName
                                        </label><br />
                                        <span data-bind="text:kriRiskName"></span>
                                    </div>
                                    <!-- /ko -->
                                    <!-- ko if: baselLossType() != null -->
                                    <div class="form-group" style="width: 33%; margin: calc(10 * 100vh / 910) calc(32 * 100vw / 1920);">
                                        <label style="margin-bottom:5px;">
                                            @Resources_Messages.Label_BaselLossType
                                        </label><br />
                                        <span data-bind="text:baselLossType"></span>
                                    </div>
                                    <!-- /ko -->
                                    <!-- ko if: baselBusinessLine() != null -->
                                    <div class="form-group" style="width: 21%; margin: calc(10 * 100vh / 910) calc(32 * 100vw / 1920);">
                                        <label style="margin-bottom:5px;">
                                            @Resources_Messages.Label_BaselBusinessLine
                                        </label><br />
                                        <span data-bind="text:baselBusinessLine"></span>
                                    </div><br />
                                    <!-- /ko -->
                                    <!-- ko if: targetValue() != null -->
                                    <div class="form-group" style="width: 33%; margin: calc(10 * 100vh / 910) calc(32 * 100vw / 1920);">
                                        <label style="margin-bottom:5px;">
                                            @Resources_Messages.Label_Target
                                        </label><br />
                                        <span data-bind="text:targetValue"></span>
                                    </div>
                                    <!-- /ko -->
                                    <!-- ko if: baselineValue() != null -->
                                    <div class="form-group" style="width: 33%; margin: calc(10 * 100vh / 910) calc(32 * 100vw / 1920);">
                                        <label style="margin-bottom:5px;">
                                            @Resources_Messages.Label_Baseline
                                        </label><br />
                                        <span data-bind="text:baselineValue"></span>
                                    </div>
                                    <!-- /ko -->
                                </div>
                            </div>
                        </div>



                        <div id="pageThirdLast" class="fixedPage">
                            <div class="form-group" id="innerDivPageThird">

                                <div class="row">
                                    <div class="form-group col-md-6 ">
                                        <label>@Resources_Messages.Label_SummaryOfChanges</label>

                                    </div>
                                </div>
                                <center>
                                    <table id="fieldhistorytable" style="table-layout:fixed;" width="96%">
                                        <tr>
                                            <th>@Resources_Messages.Label_FieldName</th>
                                            <th>@Resources_Messages.Label_PreviousValue</th>
                                            <th>@Resources_Messages.Label_ChangedValue</th>
                                            <th>@Resources_Messages.Label_ChangedBy</th>
                                            <th>@Resources_Messages.Label_ChangeDate</th>
                                            <th id="vendor_tabName" style="display:none">Tab Name</th>
                                            <th id="vendor_refferenceNumber" style="display:none">Reference Number</th>
                                        </tr>

                                    </table>
                                </center>


                            </div>
                        </div>


                        <div id="pageSecondLast" class="fixedPage">
                            <div class="form-group" id="innerDivPageSecond">

                                <div class="row">
                                    <div class="form-group col-md-6 ">
                                        <label>@Resources_Messages.Label_SummaryofComments</label>

                                    </div>
                                </div>
                                <center>
                                    <table id="fieldhistorytableComments" style="table-layout:fixed;" width="96%">
                                        <tr>
                                            <th>@Resources_Messages.Label_FieldName</th>
                                            <th>@Resources_Messages.Label_Comment</th>
                                            <th>@Resources_Messages.Label_ChangedBy</th>
                                            <th>@Resources_Messages.Label_ChangeDate</th>
                                        </tr>

                                    </table>
                                </center>


                            </div>
                        </div>

                        <div id="pageLast" class="fixedPage edit-form">
                            <div class="form-group" id="divAction">
                                <div class="row">
                                    <div class="radioGroup col-md-6">
                                        <label style="display: block">@Resources_Messages.Label_Action:</label>
                                        <div class="radio">
                                            <label id="submit" style="display:none">
                                                <input type="radio" name="radioAction" id="radioSubmit" value="SUBMIT">@Resources_Messages.Label_Submit
                                            </label>
                                        </div>
                                        <br />
                                        <div class="radio">
                                            <label id="approve" style="display:none">
                                                <input type="radio" name="radioAction" id="radioApprove" class="radioUnChecked" value="NEXT" checked>@Resources_Messages.Label_Approve
                                            </label>
                                        </div>
                                        <div class="radio">
                                            <label id="reject" style="display:none">
                                                <input type="radio" name="radioAction" id="radioReject" value="ZERO">@Resources_Messages.Label_NeedsCorrection
                                            </label>
                                        </div>
                                        <div class="radio">
                                            <label id="abort" style="display:none">
                                                <input type="radio" name="radioAction" id="radioAbort" value="END">@Resources_Messages.Label_Abort
                                            </label>
                                        </div>

                                    </div>
                                    <div class="col-md-6"></div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-md-6 required" id="remarksText">
                                        <label>@Resources_Messages.Label_Remarks</label>
                                        <input type="text" data-bind="value:comment" class="form-control actionsRemarks" id="txtComment" />
                                    </div>
                                    <div class="col-md-6"></div>
                                </div>
                                <div class="form-group row" id="divReject">
                                    <label>@Resources_Messages.Label_RejectTo</label>
                                    <div class="radioGroup">
                                        <div class="radio">
                                            <label class="radioReviewer">
                                                <input type="radio" name="radioReject" id="radioInitiator" value="Initiator">@Resources_Messages.Label_Initiator
                                            </label>
                                        </div>
                                        <div class="radio radioStage radioReviewer">
                                            <label>
                                                <input type="radio" name="radioReject" id="radioStage" value="PreviousStage">@Resources_Messages.Label_PreviousStage
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div id="divPreviousStage">
                                    <div class="row">
                                        <div class="form-group col-md-6 required">
                                            <label>@Resources_Messages.Label_SelectStage</label>
                                            <select class="form-control" id="lstStages" style="width: 100%;" name="lstStages"></select>
                                        </div>
                                    </div>
                                    <div class="row" id="assignedUserFormStagesWrapper">
                                        <div id="assignedUserFormStages">
                                            <div>
                                                <div></div>
                                                <div></div>
                                                <div></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group required col-md-6" id="divAssignUsers">
                                        <label>@Resources_Messages.Label_AssignNewUsers</label>
                                        <select id="referBackUser" name="referBackUser" multiple style="width:100%;" data-placeholder="@Resources_Messages.Label_StartTypingUsername"></select>
                                    </div>

                                    <div class="form-group required col-md-6" id="divSelectForm">
                                        <label>@Resources_Messages.Label_SelectForm:</label>
                                        <select id="referBackUserForm" name="referBackUserForm" style="width:100%;" data-placeholder="@Resources_Messages.Label_AssignAForm"></select>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-md-6" id="divAssignUserBtn">
                                        @*<button type="button" class="btn btn-block"
                                                    data-bind="click:gm.actioncentre.assignUserForm"
                                                    id="assignUserForm" tabindex="8">
                                                @Resources_Admin.Button_AddNewUser
                                            </button>*@
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>











            <div class="stages-tab" id="stage_container2" style="display:none;">

            </div>







        </div>
    </div>

    <div id="controlsListModal" class="quickview-wrapper fullWidth" style="margin-top: 8vh; ">
        @*<div class="nav tabHead action-header">
                <li class="pull-left" style="font-size:1.3em;">
                    <i class="fa fa-times quickview-toggle"
                       onclick="gm.actioncentre.closeRightPane(this)"></i>
                </li>
                <li class="col-md-12 text-center">
                    <h4 id="wfHeader">Workflow SUMMARY</h4>
                </li>
            </div>*@

        <div class="LayoutPage" data-bind="with: gm.actioncentre.selectedRow()">
            <div class="LayoutPageHeader">
                @Html.DC().Components.NavigationPanel(np =>
           {
               string cancelUrl = "gm.actioncentre.closeRightPane(this)";
               string leftClick = "tabswitchForm()";
               string rightClick = "tabswitchStages()";
               string saveClick = "gm.actioncentre.saveReviewJson()";
               string submitDraft = "draft_submit()";

               np.Tabs.Add(np.Tab(Resources_Messages.Label_Form, false, onClick: leftClick));
               np.Tabs.Add(np.Tab(Resources_Messages.Label_Stakeholders, false, onClick: rightClick));

               np.Actions.Add(np.Normal(Resources_Admin.Button_Close, onClick: cancelUrl));

               np.Actions.Add(np.ArrowLeft(onClick: leftClick));

               np.Actions.Add(np.ArrowRight(onClick: rightClick));

               np.Actions.Add(np.Change(Resources_Admin.Button_Save, onClick: saveClick));

               np.Actions.Add(np.Submit(Resources_Admin.Button_Submit, onClick: submitDraft));


           })
                @*  @{
                        Html.RenderPartial("~/Views/Shared/_NavigationPanel.cshtml",
                            new NavigationPanelModel(0)
                            .WithTab(new NavigationPanelTabModel(0, Resources_Messages.Label_Form))
                            .WithTab(new NavigationPanelTabModel(1, Resources_Messages.Label_Stakeholders))
                                .WithAction(new NavigationPanelActionModel(NavigationPanelActionModel.ButtonType.NORMAL,Resources_Messages.Label_Close)
                                    .WithAction("gm.actioncentre.closeRightPane(this)")
                                )
                                .WithAction(new NavigationPanelActionModel(NavigationPanelActionModel.ButtonType.ARROW_LEFT)
                                    .WithAction("tabswitchForm()")
                                )
                                .WithAction(new NavigationPanelActionModel(NavigationPanelActionModel.ButtonType.ARROW_RIGHT)
                                    .WithAction("tabswitchStages()")
                                )
                                .WithAction(new NavigationPanelActionModel(NavigationPanelActionModel.ButtonType.NORMAL, Resources_Messages.Label_SaveandClose)
                                    .WithAction("gm.actioncentre.saveReviewJson()")
                                )
                                .WithAction(new NavigationPanelActionModel(NavigationPanelActionModel.ButtonType.SUBMIT, Resources_Messages.Label_Submit)
                                    .WithAction("draft_submit()")
                                )
                        );
                    }*@
            </div>
            <div class="LayoutPageBody form-tab">
                <div class="LayoutPageThumbnails">
                    <div>
                        <div id="thumbnailFirstDraft" class="activeThumbnail"
                             onclick="gm.actioncentre.pageThumbnailClick(this, 'pageFirstDraft', true);">
                            <span>1</span>
                        </div>
                        <div id="thumbnailLastDraft"
                             onclick="gm.actioncentre.pageThumbnailClick(this, 'pageLastDraft', true);">
                            <span>2</span>
                        </div>
                    </div>
                </div>
                <div class="LayoutPages">
                    <div>
                        <div id="pageFirstDraft" class="fixedPage modal-body fixedPageContent">
                            <div class="form-group">
                                <label>
                                    @Resources_Messages.Label_Name
                                </label>
                                <span class="show" id="controlNamePreview" />
                            </div>
                            <div class="form-group">
                                <label>
                                    @Resources_Messages.Label_Description
                                </label>
                                <span class="show" id="controlDescriptionPreview" style="min-height:6.2vh;" />
                            </div>

                            <div class="form-group">
                                <label id="selfAttestationLabelDraft">
                                    @Resources_Messages.Label_SelfAttestation
                                </label>
                                <span class="show" id="selfAttestationPreviewDraft" />
                            </div>

                            <div class="form-group">
                                <label id="lblTitle">@Resources_Messages.Label_Title</label>
                                <input id="taskTitle" name="taskTitle" disabled placeholder="@Resources_Messages.Label_TitleWillBeAutoGenerated" style="width:100% !important;" type="text"
                                       class="form-control" />
                            </div>

                            <div class="form-group" id="divSelfAttestationDraft">
                                <label id="lblSelfAttestationDraft">@Resources_Messages.Label_SelectCertificate</label>
                                <select id="selfAttestationListDraft" name="selfAttestationListDraft" style="width:100% !important;"
                                        class="form-control" data-placeholder="@Resources_Messages.Label_SelectCertificate"></select>
                            </div>

                            @*<div class="form-group">
                                    <label id="lblControl">Select</label>
                                    <select id="controlList" name="controlList" style="width:100% !important;"
                                            class="form-control" data-placeholder="Select"></select>
                                </div>

                                <div class="form-group">
                                    <label id="lblControlDescription">Control Description :</label>
                                    <p id="controlDescription"></p>
                                </div>*@
                            <div class="modal-body checkbox-radios" id="radioGroupsforcontrol">
                                <div class="radio">


                                    <label id="controls"
                                           style="cursor:not-allowed;color:rgba(0, 0, 0, 0.26)!important;">
                                        @Resources_Messages.Label_Control
                                        <input id="radioCon" type="radio" value="con"
                                               name="typecontrol" disabled />
                                    </label>
                                    <label id="risks"
                                           style="cursor:not-allowed;color:rgba(0, 0, 0, 0.26)!important;">
                                        @Resources_Messages.Label_Risk
                                        <input id="radioRisk" type="radio" value="risk"
                                               name="typecontrol" disabled />
                                    </label>
                                </div>
                            </div>
                            <div class="modal-body form-group">
                                <label id="lblControl">@Resources_Messages.Label_Select</label><span class="text-danger">*</span>
                                <select id="controlList" name="controlList"
                                        style="width:100% !important;"
                                        class="form-control" data-placeholder=@Resources_Messages.Label_Select></select>
                            </div>
                            <div class="checkbox-radios" id="radioGroups" style="position:relative; left:1vw;">
                                <div class="radio">
                                    <label id="itSystems" style="cursor:not-allowed;color:rgba(0, 0, 0, 0.26)!important;">
                                        @Resources_Messages.Label_ITSystems
                                        <input id="radioIts" type="radio" value="its" name="type" disabled />
                                    </label>
                                    <label id="policies" style="cursor:not-allowed;color:rgba(0, 0, 0, 0.26)!important;">
                                        @Resources_Messages.Label_Policies
                                        <input id="radioPol" type="radio" value="pol" name="type" disabled />
                                    </label>
                                    <label id="processes" style="cursor:not-allowed;color:rgba(0, 0, 0, 0.26)!important;">
                                        @Resources_Messages.Label_Processes
                                        <input id="radioPro" type="radio" value="pro" name="type" disabled />
                                    </label>

                                </div>
                            </div>

                            @*<div class="modal-body form-group">
                                    <label id="lblReference">Select</label>
                                    <select id="referenceList" name="referenceList"
                                            class="form-control" data-placeholder="Select" style="width:100% !important;"></select>
                                </div>*@
                            <div class="modal-body form-group">
                                <label id="lblReference">@Resources_Messages.Label_Select</label>
                                <label>
                                    <span class="text-danger"></span>
                                </label>
                                <select id="referenceList" name="referenceList"
                                        class="form-control" data-placeholder=@Resources_Messages.Label_Select
                                        style="width:100% !important;"></select>
                            </div><br />

                            <div class="form-group">
                                <a target="_blank" id="processUrl" href="#">@Resources_Messages.Label_ViewProcess</a>
                                <br />
                                <label>@Resources_Messages.Label_Status:</label>
                                <label></label>
                            </div>





                        </div>
                        <div id="pageLastDraft" class="fixedPage">
                            <div class=" form-group">
                                <label>
                                    @Resources_Messages.Label_TargetDateToCloseTask
                                    <span class="text-danger">*</span>
                                </label>
                                <input type="text" class="datepicker form-control" placeholder="@Resources_Messages.Label_EnterTargetDateToCloseTheTask" id="taskTargetDate" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="stages-tab" id="stage_container" style="display:none;">
                <div class="card min-height-500">
                    <div class="edit-form new-design-theme workflow-acess-rights-content">
                        <div class="noStagesAddedDiv" style="display: none;">
                            <h2>@Resources_Messages.Label_NoStagesAreAdded</h2>
                        </div>
                        <form action='@Url.Action("UpdateStages", "Workflow")' method="post" enctype="multipart/form-data" id="frmCreateStages">
                            <div @*class="card p-b-10"*@ id="multiplestages" style="display:none;">
                                <div class="new-design-theme workflow-acess-rights-card stages_btn_panel">
                                    <div class="incDecContainer">
                                        <span class="glyphicon glyphicon-minus cursor" style="font-size: 16px;" id="minus"></span>
                                        <input type="number" min="0" max="15" id="numberOfStages" placeholder="@Resources_Messages.Label_NumberOfApprovalStages" data-bind="value:numberOfStages" />
                                        <span class="glyphicon glyphicon-plus cursor" style="font-size: 16px;" id="plus"></span>
                                    </div>
                                </div>
                                <label class="m-lr-20 number_stages">@Resources_Messages.Label_NumberOfApprovalStages</label>
                                @*<div class="checkbox m-lr-20" style="display: block;">*@
                                <label class="simple-check-box stages_checkbox" data-bind="attr:{'for':'approvalNotNeeded'}" style="display:none;">
                                    <input type="checkbox" class="approvalNeededCheck" data-bind="attr:{'checked':approvalNotNeeded,'id':'approvalNotNeeded', 'name':'approvalNotNeeded'}">
                                    @Resources_Messages.Label_NoStagesRequired
                                </label>
                                @*</div>*@
                            </div>
                            <div id="stageWrapper">
                                <div class="stageMain fullWidth p-t-10">
                                    <!-- TOP CONTENT -->
                                    <div class="workflow-stages-card supervisor">
                                        <label class="simple-check-box" data-bind="attr:{'for':'supervisorApproval'}">
                                            <input type="checkbox" class="approvalNeededCheck" disabled="disabled" data-bind="attr:{'checked':supervisorApproval,'id':'supervisorApproval', 'name':'supervisorApproval'}">
                                            @Resources_Messages.Label_SupervisorReview
                                        </label>
                                    </div>


                                    <!-- MAIN CONTENT -->
                                    <ul data-bind="foreach:addedStageList" style="padding: 0;" class="new-design-theme workflow-stages-container" @*style="list-style: none; padding-left: 0;"*@>

                                        <div class="drop-div" ondrop="drop(event)" ondragover="allowDrop(event)" ondragenter="dragenter(event,this)" ondragleave="dragleave(event,this)"></div>
                                        <li @*class="border marginFull liStage card"*@ class="list-item" draggable="true" ondragstart="drag(event,this)" ondragend="dragend(event)" data-bind="attr:{'id':'stagedrag_'+ ($index() + 1)}">
                                            <div class="list-item-header closed" data-init="0">
                                                <span class="pull-left stageTitleElement glyphicon glyphicon-chevron-down dropDownArrow cursor fs-18" data-bind="attr:{'id':'openDetails_'+ ($index() + 1)}"></span>
                                                <span class="highlight bold stageTitleElement p-l-15 stage-item-title" data-bind="text:'@Resources_Messages.Label_Stage' + ($index() + 1)"></span> : <span data-bind="text : StageName" class="stage_name_text"></span>
                                                <label class="simple-check-box mandatoryCheck_label" style="color:white; position:absolute; right:150px; ">
                                                    @Resources_Messages.Label_IsThisStageMandatory &nbsp;&nbsp;&nbsp;
                                                    <input type="checkbox" class="mandatoryCheck" data-bind="attr:{'checked':IsMandatory,'id':'stageAllIsMandatory_' +  ($index() + 1), 'name':'stageAllIsMandatory_' +  ($index() + 1)}" />

                                                </label>

                                                <span class="pull-right cursor glyphicon glyphicon-pushpin fix p-r-15 fs-18" onclick="fixClick(this)" data-bind="attr:{'id':'stageAllIsPinned_'+ ($index() + 1)}" style=""></span>
                                                <span class="pull-right cursor glyphicon glyphicon-trash delete p-r-15 fs-18" data-bind="attr:{'id':'deleteStage_'+ ($index() + 1)}"></span>

                                                <span class="clear"></span>
                                            </div>
                                            <ul class="options" data-bind="visible:false" style="list-style: none; padding-inline-end: 40px; height: fit-content;">
                                                <li class="flex-row">
                                                    <div style="width:48% !important;">
                                                        <div class="form-group required">
                                                            <label>@Resources_Messages.Label_StageName</label>
                                                            <input class="form-control stage_name_input" onkeyup="stageNameChanged(this)" style="width: 400px;" maxlength="150" type="text" placeholder="@Resources_Messages.Label_StageName" data-bind="value:StageName, attr: {'id': 'stageName_' + ($index + 1)}" />
                                                        </div>
                                                    </div>
                                                    <div data-bind="attr:{'id':'stageActions_' +  ($index() + 1)}" style="width:48% !important;">
                                                        <div class="form-group required">
                                                            <label>@Resources_Messages.Label_SelectAtLeastOneAction</label>
                                                            @Html.EditorFor(m => m, "ActionSelect")
                                                        </div>
                                                    </div>
                                                </li>
                                                <li class="flex-row m-t-20">
                                                    <div style="height: 33px; padding-top: 8px; width:48% !important;">
                                                        <label class="text-boldcolor bold ">@Resources_Messages.Label_ReviewWithin</label>
                                                        <span class="number-input-container" style="border-bottom: 1px solid #CCC;">
                                                            <input maxlength="3" type="number" min="0" placeholder="" disabled="disabled" data-bind="value:ReviewBy, attr: {'id': 'reviewBy' + ($index + 1)}" style="background: transparent; border: none; width: 45px; padding-left: 10px; margin-right: 10px;" />
                                                            <span onclick="this.previous
    Sibling.value++" style="visibility:hidden;"><i class="glyphicon glyphicon-chevron-up"></i></span>
                                                            <span onclick="this.previousElementSibling.previousElementSibling.value--" style="visibility:hidden;"><i class="glyphicon glyphicon-chevron-down"></i></span>
                                                        </span>

                                                        <label class="bold text-boldcolor">@Resources_Messages.Label_Days</label>
                                                    </div>
                                                    <div class="checkbox" disabled="true" style="margin: 0; visibility:hidden; width:48% !important;">
                                                        <label data-bind="attr:{'for':'stageAllApprovalMandatory_' +  ($index() + 1)}">
                                                            @Resources_Messages.Label_UnanimousApprovalMandatory
                                                            <input type="checkbox" class="approvalCheck" data-bind="attr:{'checked':ApprovalMandatory,'id':'stageAllApprovalMandatory_' +  ($index() + 1), 'name':'stageAllApprovalMandatory_' +  ($index() + 1)}" />

                                                        </label>
                                                    </div>
                                                </li>
                                                @*<li class="m-t-20" data-bind="attr:{'id':'stageActions_' +  ($index() + 1)}">

                                                        <div class="form-group required">
                                                            <label>@Resources_Admin.Label_SelectValidActions</label>
                                                            @Html.EditorFor(m => m, "ActionSelect")
                                                        </div>

                                                    </li>*@

                                                @*<li class="m-t-20">
                                                        <div class="checkbox">
                                                            <label data-bind="attr:{'for':'stageAllApprovalMandatory_' +  ($index() + 1)}">
                                                                <input type="checkbox" class="approvalCheck" data-bind="attr:{'checked':ApprovalMandatory,'id':'stageAllApprovalMandatory_' +  ($index() + 1), 'name':'stageAllApprovalMandatory_' +  ($index() + 1)}" />
                                                                @Resources_Admin.Label_UnanimousApproval
                                                            </label>
                                                        </div>
                                                    </li>*@

                                                <li class="m-t-20" data-bind="attr:{'id':'stageFormGroup_' +  ($index() + 1)}">
                                                    <div class="form-group">
                                                        <label>@Resources_Messages.Label_FormStages</label>
                                                        @*<button class="btn btn-success btn-sm" type="button" data-bind="click:gm.stage.addFormGroup">
                                                                <i class="glyphicon glyphicon-plus"></i>
                                                                <span class="bold">Add</span>
                                                            </button>*@
                                                    </div>
                                                    <table class="table table-bordered m-b-20 stages-table">
                                                        <thead>
                                                            <tr>
                                                                <th style="width: calc(50 * 100vw / 1920); padding: 0">
                                                                    <button class="btn btn-success btn-sm" type="button" disabled="disabled" data-bind="click:gm.stage.addFormGroup">
                                                                        <i class="glyphicon glyphicon-plus" style="position: relative;top: 1px;right: 0;"></i>
                                                                    </button>
                                                                </th>
                                                                <th>@Resources_Messages.Label_AssignedUsersRoles </th>
                                                                <th style="width: calc(200 * 100vw / 1920);" class="Hideclass">@Resources_Messages.Label_SectionHeader</th>
                                                                <th style="width: calc(40 * 100vw / 1920);" class="Hideclass">@Resources_Messages.Label_Form</th>
                                                                <th style="width: calc(40 * 100vw / 1920);" class="Hideclass">@Resources_Messages.Label_Delete</th>
                                                            </tr>
                                                        </thead>
                                                        <tr data-bind="visible: FormGroup().length == 0">
                                                            <td colspan="5" align="center" style="padding: 15px">
                                                                <span>@Resources_Messages.Label_NoFormsAdded</span>
                                                            </td>
                                                        </tr>

                                                        <tbody data-bind="foreach:FormGroup">
                                                            <tr>
                                                                <td class=" blockmiddle" style="text-align: center" data-bind="text:$index()+1"></td>
                                                                <td class=" blockmiddle" style="padding: 0 15px" data-bind="attr:{'data-stageNumber':$parentContext.$index(), 'data-formIndex':$index(), 'id':'stageForm_'+$parentContext.$index()+'_' +  ($index())}">
                                                                    <select class="form-control formStagesUsers" multiple style="width: 100%" placeholder="@Resources_Messages.Label_ClickToAssignUser"></select>
                                                                </td>
                                                                <td class="blockmiddle Hideclass">
                                                                    <input type="text" class="form-control" data-bind="value:Header" placeholder="@Resources_Messages.Label_TypeFormName" style="width: 100%" />
                                                                </td>
                                                                <td style="color: black; position:relative; font-size: calc(20*(50vh + 23.5vw)/910); text-align: center" class="Hideclass">
                                                                    <span class="glyphicon glyphicon-eye-open" data-bind="click: function(data, event) {  gm.stage.editStageForm($parent,$index) } "></span>
                                                                </td>
                                                                <td style="color: red; font-size: calc(20*(50vh + 23.5vw)/910); text-align: center" class="Hideclass">
                                                                    @*<span class="fa fa-close cursor" data-bind="click: function(data, event) {  gm.stage.removeStageForm($parent,$data) } "></span>*@
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </li>
                                            </ul>
                                        </li>
                                        <div class="drop-div" ondrop="drop(event)" ondragover="allowDrop(event)" ondragenter="dragenter(event,this)" ondragleave="dragleave(event,this)"></div>

                                    </ul>

                                    <div class="fieldName normal" id="divConfirmationPopUp">
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>









            </div>


        </div>
        @*<div class="modal-footer m-b-50">
                <button type="button" class="btn btn-success pull-right" id="btnSaveSubmit">
                    Save
                </button>
                <button class="btn btn-success pull-right" type="button" id="raiseActionSubmit">
                    @Resources_Admin.Button_Submit
                </button>
                <button class="btn btn-github pull-right m-r-10" type="button"
                        onclick="gm.actioncentre.closeRightPane(this)">
                    @Resources_Admin.Button_Close
                </button>
            </div>*@
    </div>

    <div class="modalComment modal fade" id="divCommentPopUp" tabindex="-1"
         role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog-background" data-dismiss="modal"></div>
        <div class="modal-dialog modal-lg">
            <div class="modal-content" id="history_Div" style="background-color: #eee;">
                <div class="modal-header" id="history_Divheader">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        <img className="request-navbar-cross" style="height:3vh" src="\Views\Risk\icons\CloseIcon.svg" />
                    </button>
                    <h4 class="modal-title">
                        @Resources_Messages.Label_FieldHistory
                    </h4>
                </div>
                <div class="modal-body" id="actionFormCommentHistory" style="">

                </div>
                <div class="modal-body">
                    <input rows="1" class="form-control" type="text"
                           value="" id="CommentTextArea" />
                    <button type="button" id="SaveCommentBtn">
                        <svg viewBox="0 0 16 22">
                            <use xlink:href="#action-save-comment" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="approvalHistoryModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-header-title">
                        <button type="button" class="close" data-dismiss="modal">
                            <svg width="25" height="25" viewBox="0 0 25 20"><use xlink:href="#close-modal" /></svg>
                        </button>
                        <h4 class="modal-title">@Resources_Messages.Label_ApprovalHistory</h4>
                    </div>
                </div>
                <div class="modal-body">
                    <div id="no-stages-wrapper"></div>
                    <div class="row">
                        <div class="col-md-3 modal-stages-wrapper">
                            <div id="stages-list-icons"></div>
                            <div id="stages-list-stage-names"></div>
                        </div>
                        <div class="col-md-9" id="stages-details"></div>
                    </div>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->











    <style>
        #amendment_popup {
            width: 95.7%;
            height: 100vh;
            background: white;
            position: fixed;
            top: 0;
            z-index: 1000;
            right: 0;
            display: none;
        }

            #amendment_popup.open {
                display: block;
            }

        #top_menu {
            background: #2C2F48;
        }

        #show_form {
            border: 2px solid white;
            background: transparent;
            border-radius: 0.5vw 0 0 0.5vw;
        }

        #show_stages {
            border: 2px solid white;
            background: transparent;
            border-radius: 0 0.5vw 0.5vw 0;
            border-left: 0;
        }

        #approvalHistoryModal .modal-dialog {
            width: 100% !important;
        }
    </style>
    <div id="amendment_popup">

        <div id="top_menu">
            <div class="center-cell">
                <div id="tab" class="btn-group" data-toggle="buttons">

                    <a href="#form" id="show_form" class="btn active" data-toggle="tab">
                        <input type="radio" />@Resources_Messages.Label_Form.ToUpper()
                    </a>
                    <a href="#stages" id="show_stages" class="btn" data-toggle="tab">
                        <input type="radio" />@Resources_Messages.Label_Stakeholders.ToUpper()
                    </a>
                </div>
            </div>
        </div>
        <div class="LayoutPage" data-bind="with: gm.actioncentre.selectedRow()">

            <div class="LayoutPageBody">
                <div class="LayoutPageThumbnails">
                    <div>
                        <div id="thumbnailFirst" class="activeThumbnail"
                             onclick="gm.actioncentre.pageThumbnailClick(this, 'pageFirst');">
                            <span>1</span>
                        </div>
                        <div id="thumbnailLast"
                             onclick="gm.actioncentre.pageThumbnailClick(this, 'pageLast');">
                            <span>2</span>
                        </div>
                    </div>
                </div>
                <div class="LayoutPages">
                    <div>
                        <div id="pageFirst" class="fixedPage">

                            <div id="actionBody" class="modal-body fixedPageContent">
                                <div class="form-group">
                                    <label>
                                        @Resources_Messages.Label_Title
                                    </label>
                                    <span class="show" data-bind="text:title" />
                                </div>
                                <div class="form-group">
                                    <label>
                                        @Resources_Messages.Label_Name
                                    </label>
                                    <span class="show" data-bind="text:name" />
                                </div>
                                <div class="form-group">
                                    <label>
                                        @Resources_Messages.Label_ReferenceNumber
                                    </label>
                                    <span class="show" data-bind="text:referenceNumber" />
                                </div>
                                <div class="form-group hidden" id="originTaskDataArea">
                                    <label>
                                        @Resources_Messages.Label_OriginTask
                                    </label>
                                    <a class="show btn btn-info" href="#" style="width: 300px;"></a>
                                </div>
                                <div class="form-group hidden" id="amendmentTaskDataArea">
                                    <label>
                                        @Resources_Messages.Label_AmendmentTask
                                    </label>
                                    <a class="show btn btn-info" href="#" style="width: 300px;"></a>
                                </div>

                                <div class="form-group">
                                    <label id="selfAttestationLabel">
                                        @Resources_Messages.Label_SelfAttestation
                                    </label>
                                    <span class="show" id="selfAttestationPreview" />
                                </div>

                                <div class="form-group" id="divSelfAttestation">
                                    <label id="lblSelfAttestation">@Resources_Messages.Label_Certificate</label>
                                    <select id="selfAttestationList" name="selfAttestationList" style="width:100% !important;"
                                            class="form-control"></select>
                                </div>

                                <!-- ko if: controlName() != null -->
                                <div class="form-group">
                                    <label>
                                        @Resources_Messages.Label_ControlName
                                    </label>
                                    <span class="show" data-bind="text:controlName" />
                                </div>
                                <!-- /ko -->
                                <!-- ko if: riskName() != null -->
                                <div class="form-group">
                                    <label>
                                        @Resources_Messages.Label_RiskName
                                    </label>
                                    <span class="show" data-bind="text:riskName"></span>
                                    <div class="printTextBox" style="display: none;"
                                         data-bind="text:riskName"></div>
                                </div>
                                <!-- ko if: controlDescription() != null -->
                                <div class="form-group">
                                    <label>
                                        @Resources_Messages.Label_ControlDescription
                                    </label>
                                    <span class="show" data-bind="text:controlDescription" />
                                </div>
                                <!-- /ko -->
                                <!-- ko if: itSystemName() != null -->
                                <div class="form-group">
                                    <label>
                                        @Resources_Messages.Label_ITSystemName
                                    </label>
                                    <span class="show" data-bind="text:itSystemName" />
                                </div>
                                <!-- /ko -->
                                <!-- ko if: processName() != null -->
                                <div class="form-group">
                                    <label>
                                        @Resources_Messages.Label_ProcessName
                                    </label>
                                    <span class="show" data-bind="text:processName" />
                                </div>
                                <!-- /ko -->
                                <!-- ko if: policyName() != null -->
                                <div class="form-group">
                                    <label>
                                        @Resources_Messages.Label_PolicyName
                                    </label>
                                    <span class="show" data-bind="text:policyName" />
                                </div>
                                <!-- /ko -->
                                <!-- ko if: url() != null -->
                                <div class="form-group">
                                    <a data-bind="attr: { href: url() }" target="_blank">@Resources_Messages.Label_ViewProcessImage</a>
                                    <br />
                                    <label>@Resources_Messages.Label_Status:</label>
                                    <label data-bind="text: urlStatus"></label>
                                </div>
                                <!-- /ko -->
                                <div id="rejectProcessRCSA" class="form-group" style="display: none; visibility:hidden;">
                                    <label>
                                        @Resources_Messages.Label_RejectProcess
                                    </label>
                                    <input type="checkbox" id="chkRejectProcess"
                                           style="vertical-align: top; margin-top: 5px;" />
                                    <div id="rejectProcessComment">
                                        <label>
                                            @Resources_Messages.Label_ProcessComment
                                        </label>
                                        <input id="rejectProcessCommentTb" placeholder="Enter Process Comment."
                                               type="text" class="form-control" />
                                    </div>
                                </div>

                                <div id="exceptionCountPreviewArea" class="material-datatables" style="display: none;">
                                    <div class="table-responsive">
                                        <table id="exceptionCountList" class="table table-striped table-no-bordered table-hover" style="width: 100% !important">
                                            <thead>
                                                <tr>
                                                    <th></th>
                                                    <th>@Resources_Messages.Label_Name</th>
                                                    <th style="position:relative; left:0px;">@Resources_Messages.Label_Type</th>
                                                    <th style="position:relative; right:20px;">@Resources_Messages.Label_Open</th>
                                                    <th style="position:relative; right:20px;">@Resources_Messages.Label_Closed</th>
                                                    <th style="position:relative; right:20px;">@Resources_Messages.Label_Total</th>
                                                </tr>
                                            </thead>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="pageLast" class="fixedPage edit-form">
                            <div class="form-group" id="divAction">                                
                                <div class="row">
                                    <div class="radioGroup col-md-6">
                                        <label style="display: block">@Resources_Messages.Label_Action:</label>
                                        <div class="radio">
                                            <label>
                                                <input type="radio" name="radioAction2" id="radioApprove2" value="NEXT">@Resources_Messages.Label_Approve
                                            </label>
                                        </div>
                                        <div class="radio">
                                            <label>
                                                <input type="radio" name="radioAction2" id="radioReject2" value="ZERO">@Resources_Messages.Label_Reject
                                            </label>
                                        </div>
                                        @*<div class="radio">
                                                <label>
                                                    <input type="radio" name="radioAction" id="radioAbort" value="END">Abort
                                                </label>
                                            </div>*@
                                    </div>
                                    <div class="col-md-6"></div>
                                </div>
                                @*<div class="row">
                                        <div class="form-group col-md-6 required" id="remarksText">
                                            <label>Remarks</label>
                                            <input type="text" data-bind="value:comment" class="form-control actionsRemarks" id="txtComment" />
                                        </div>
                                        <div class="col-md-6"></div>
                                    </div>*@
                                <div class="form-group row" id="divReject">
                                    <label>@Resources_Messages.Label_RejectTo</label>
                                    <div class="radioGroup">
                                        <div class="radio">
                                            <label>
                                                <input type="radio" name="radioReject" id="radioInitiator" value="Initiator" checked="checked">@Resources_Messages.Label_Initiator
                                            </label>
                                        </div>
                                        <div class="radio radioStage">
                                            <label>
                                                <input type="radio" name="radioReject" id="radioStage" value="PreviousStage">@Resources_Messages.Label_PreviousStage
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div id="divPreviousStage">
                                    <div class="row">
                                        <div class="form-group col-md-6 required">
                                            <label>@Resources_Messages.Label_SelectStage</label>
                                            <select class="form-control" id="lstStages" style="width: 100%;" name="lstStages"></select>
                                        </div>
                                    </div>
                                    <div class="row" id="assignedUserFormStagesWrapper">
                                        <div id="assignedUserFormStages">
                                            <div>
                                                <div></div>
                                                <div></div>
                                                <div></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group required col-md-6" id="divAssignUsers">
                                        <label>@Resources_Messages.Label_AssignNewUsers</label>
                                        <select id="referBackUser" name="referBackUser" multiple style="width:100%;" data-placeholder="@Resources_Messages.Label_StartTypingUsername"></select>
                                    </div>

                                    <div class="form-group required col-md-6" id="divSelectForm">
                                        <label>@Resources_Messages.Label_SelectForm:</label>
                                        <select id="referBackUserForm" name="referBackUserForm" style="width:100%;" data-placeholder="@Resources_Messages.Label_AssignAForm"></select>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-md-6" id="divAssignUserBtn">
                                        <button type="button" class="btn btn-block"
                                                data-bind="click:gm.actioncentre.assignUserForm"
                                                id="assignUserForm" tabindex="8">
                                            @Resources_Messages.Label_AddNewUser
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


    </div>

    <script type="text/javascript">

        $(document).ready(function () {
            $('#DueList_Task').DataTable({
                "columns":
                    [
                        { "data": "title", "title": "@Resources_Messages.Label_Title" },
                        { "data": "referenceNumber", "title": "@Resources_Messages.Label_ReferenceID" },
                        { "data": "businessControlTypeName", "title":"@Resources_Messages.Label_Type" },
                        { "data": "dueDate", "title":"@Resources_Messages.Label_TargetDate"},
                        { "data": "actionType", "title":"@Resources_Messages.Label_Action" },
                        { "data": "actionType", "title": "@Resources_Messages.Label_Status" },
                    ]
            });
        });

        $(document).ready(function() {
            $('#OverdueList_Task').DataTable({
                "columns":
                    [
                        { "data": "title", "title": "@Resources_Messages.Label_Title" },
                        { "data": "referenceNumber", "title": "@Resources_Messages.Label_ReferenceID" },
                        { "data": "businessControlTypeName", "title":"@Resources_Messages.Label_Type" },
                        { "data": "dueDate", "title":"@Resources_Messages.Label_TargetDate"},
                        { "data": "actionType", "title":"@Resources_Messages.Label_Action" },
                        { "data": "actionType", "title": "@Resources_Messages.Label_Status" },
                    ]
            });
        });

        $(document).ready(function () {
            $('#UpcomingList_Task').DataTable({
                "columns":
                    [
                        { "data": "title","title": "@Resources_Messages.Label_Title" },
                        { "data": "referenceNumber","title": "@Resources_Messages.Label_ReferenceID" },
                        { "data": "businessControlTypeName","title":"@Resources_Messages.Label_Type" },
                        { "data": "dueDate","title":"@Resources_Messages.Label_TargetDate"},
                        { "data": "actionType","title":"@Resources_Messages.Label_Action" },
                        { "data": "actionType", "title": "@Resources_Messages.Label_Status" },
                    ]
            });
        });


        $(document).ready(function() {
            $('#InprogressList_Task').DataTable({
                "columns":
                    [
                        { "data": "title", "title": "@Resources_Messages.Label_Title"},
                        { "data": "referenceNumber", "title": "@Resources_Messages.Label_ReferenceID"},
                        { "data": "businessControlTypeName",  "title":"@Resources_Messages.Label_Type" },
                        { "data": "dueDate",  "title":"@Resources_Messages.Label_TargetDate"},
                        { "data": "actionType", "title": "@Resources_Messages.Label_Status" },
                    ]
            });
        });

        $(document).ready(function() {
            $('#CompletedList_Task').DataTable({
                "columns":
                    [
                        { "data": "title", "title": "@Resources_Messages.Label_Title" },
                        { "data": "referenceNumber","title": "@Resources_Messages.Label_ReferenceID" },
                        { "data": "businessControlTypeName","title":"@Resources_Messages.Label_Type" },
                        { "data": "completedDate","title":"@Resources_Messages.Label_SubmittedDate"},
                        { "data": "actionType", "title": "@Resources_Messages.Label_Status" },
                    ]
            });
        });

        $(document).ready(function() {
            $('#DraftList_Task').DataTable({
                "columns":
                    [
                        { "data": "name","title": "@Resources_Messages.Label_Name" },
                        { "data": "businessControlTypeName","title": "@Resources_Messages.Label_Type" },
                        { "data": "dueDate","title":"@Resources_Messages.Label_CreatedDate" },
                        { "data": "actionType", "title": "@Resources_Messages.Label_Action" },
                    ]
            });
        });


        function showAmendmentPopup() {
            $("#amendment_popup").show(1000);
        }

        var fmData = "{\"action\":[{\"type\":\"checkbox-group\",\"label\":\"Checkbox Group\",\"name\":\"checkbox-group-1575888589489\",\"url\":\" \",\"values\":[{\"label\":\"Option 1\",\"value\":\"option-1\",\"selected\":true}],\"hidden\":false},{\"type\":\"layout\",\"elements\":[{\"type\":\"page\",\"label\":\"Page\",\"name\":\"page-1\",\"pageHeight\":\"842\",\"pageNumbers\":\"7\",\"pages\":[{\"elements\":[{\"name\":\"checkbox-group-1575888589489\"}]},{\"elements\":[]}]}]}]}";


        // var reaRef;
        //if (fmData == null) {
        //    fmData = fmData;
        //}
        //reaRef = ReactDOM.render(React.createElement(FormRender,
        //        {
        //            data: JSON.parse(fmData)
        //        }),
        //    document.getElementById("amendment_form_container"));

    </script>



    <svg style="display: none">
        <symbol width="25" height="25" viewBox="0 0 25 25" id="action-open-view">
            <g id="Group_4225" data-name="Group 4225" transform="translate(-1676.34 -958.973)">
                <path id="Path_1306" data-name="Path 1306" d="M1696.335,958.972h-14.969a.992.992,0,0,0-1.025.954v17.1a.992.992,0,0,0,1.025.954h3.084V964.075l11.885-4.026v17.1l-2.457.832h2.457a.992.992,0,0,0,1.025-.954v-17sav.1A.992.992,0,0,0,1696.335,958.972Z" transform="translate(0 0)" />
                <path id="Path_1307" data-name="Path 1307" d="M1689.172,983.972a1.184,1.184,0,0,1-.672-.209,1.152,1.152,0,0,1-.5-.947V964.451a1.157,1.157,0,0,1,.771-1.086l12.049-4.324a1.186,1.186,0,0,1,1.073.14,1.151,1.151,0,0,1,.5.947v18.365a1.157,1.157,0,0,1-.771,1.086l-12.049,4.324A1.18,1.18,0,0,1,1689.172,983.972Zm1.172-18.711v15.9l9.7-3.482v-15.9Zm10.877,13.232h0Z" transform="translate(-4.912 0)" />
            </g>
        </symbol>

        <symbol width="25" height="25" viewBox="0 0 25 25" id="action-save">
            <g id="Action_Save" clip-path="url(#clip-Action_Save)">
                <path id="DISKETTE" d="M237,2476.047a1.172,1.172,0,0,1-1.172,1.172H213.172a1.172,1.172,0,0,1-1.172-1.172v-21.875a1.172,1.172,0,0,1,1.172-1.171h3.516v1.563h0v4.3h0v3.516a2.344,2.344,0,0,0,2.288,2.344h10.269a2.343,2.343,0,0,0,2.287-2.344v-3.516h0v-4.3h0V2453h.781a1.166,1.166,0,0,1,.829.343h0l3.516,3.516h0a1.168,1.168,0,0,1,.343.829Zm-6.641-13.672a1.173,1.173,0,0,1-1.172,1.175h-1.563v0h-7.031v0h-1.562a1.173,1.173,0,0,1-1.172-1.175v-2.344h0V2453h12.5v7.031h0Zm-2.344-7.812H224.5v7.422h3.516Z" transform="translate(-211.777 -2452)" fill-rule="evenodd" />
            </g>
        </symbol>

        <symbol width="25" height="25" viewBox="0 0 25 25" id="action-submit">
            <g id="Action_Submit" clip-path="url(#clip-Action_Submit)">
                <path id="DOCUMENT__x2F__UPLOAD_1_" d="M20.565,19.355a1.1,1.1,0,0,1-.847-.363l-.766-.766V23.79a1.21,1.21,0,0,1-2.419,0V18.226l-.766.766a1.1,1.1,0,0,1-.847.363,1.188,1.188,0,0,1-1.21-1.21,1.1,1.1,0,0,1,.363-.847L16.9,14.476a1.257,1.257,0,0,1,.847-.363,1.1,1.1,0,0,1,.847.363L21.411,17.3a1.257,1.257,0,0,1,.363.847A1.188,1.188,0,0,1,20.565,19.355Zm-7.339-2.9a2.276,2.276,0,0,0-.726,1.694,2.426,2.426,0,0,0,2.419,2.419,1.372,1.372,0,0,0,.4-.04v2.863H1.21A1.188,1.188,0,0,1,0,22.177V1.21A1.188,1.188,0,0,1,1.21,0H7.661V6.855a2.426,2.426,0,0,0,2.419,2.419h7.661V12.9a2.276,2.276,0,0,0-1.694.726ZM10.081,8.065a1.188,1.188,0,0,1-1.21-1.21V0h0l8.871,8.065H10.081Z" transform="translate(2)" fill-rule="evenodd" />
            </g>
        </symbol>

        <symbol width="25" height="25" viewBox="0 0 25 25" id="action-review">
            <g id="Action_Review" clip-path="url(#clip-Action_Review)">
                <path id="BOOK" d="M1023.259,1136h-1.293v-25h1.293a1.293,1.293,0,0,1,1.293,1.293v22.414A1.293,1.293,0,0,1,1023.259,1136Zm-17.672-1.293v-1.293h2.155a2.586,2.586,0,0,0,0-5.173h-2.155v-2.155h2.155a2.586,2.586,0,0,0,0-5.172h-2.155v-2.155h2.155a2.586,2.586,0,1,0,0-5.172h-2.155v-1.293a1.293,1.293,0,0,1,1.293-1.293h13.793v25h-13.793A1.293,1.293,0,0,1,1005.586,1134.707Zm3.448-18.534a1.293,1.293,0,0,1-1.293,1.293h-3.448a1.293,1.293,0,1,1,0-2.586h3.448A1.293,1.293,0,0,1,1009.034,1116.173Zm-4.741,6.034h3.448a1.293,1.293,0,0,1,0,2.586h-3.448a1.293,1.293,0,0,1,0-2.586Zm0,7.328h3.448a1.293,1.293,0,1,1,0,2.586h-3.448a1.293,1.293,0,1,1,0-2.586Z" transform="translate(-1001 -1111)" fill-rule="evenodd" />
            </g>
        </symbol>
    </svg>

    <svg style="display:none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="20" height="20" viewBox="0 0 20 20">
        <symbol width="25" height="25" viewBox="0 0 25 25" id="close-modal" fill="#ffffff">
            <g id="Misc_Close" clip-path="url(#clip-Misc_Close)">
                <rect id="Rectangle_664" data-name="Rectangle 664" width="3" height="23" transform="translate(0.999 3.12) rotate(-45)" />
                <rect id="Rectangle_665" data-name="Rectangle 665" width="3" height="23" transform="translate(17.264 1) rotate(45)" />
            </g>
        </symbol>
    </svg>

    <svg style="display:none" xmlns="http://www.w3.org/2000/svg"
         xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 16 22">
        <symbol width="16" height="22" viewBox="0 0 16 22" id="action-save-comment">
            <g>
                <path d="M1,1 15,11.5 1,21Z" stroke="#4D94FF" stroke-width="2" fill="transparent" />
            </g>
        </symbol>
    </svg>

    <div class="modal fade" id="printDialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-header-title">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        <h5 class="modal-title">@Resources_Messages.Label_Print</h5>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" onchange="printModal.toggleComments()" checked id="toggleComments">
                        <label class="form-check-label" for="toggleComments">
                            @Resources_Messages.Label_IncludeSummaryOfComments
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" onchange="printModal.toggleSummary()" checked id="toggleSummary">
                        <label class="form-check-label" for="toggleSummary">
                            @Resources_Messages.Label_IncludeSummaryOfChanges
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" onchange="printModal.toggleApproval()" checked id="toggleApproval">
                        <label class="form-check-label" for="toggleApproval">
                            @Resources_Messages.Label_IncludeApprovalHistory
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success" onclick="printModal.print()">@Resources_Messages.Label_Print</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">@Resources_Messages.Label_Cancel</button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->
}

@section Scripts {

    @Scripts.Render("~/bundles/formbuilder")
    @Scripts.Render("~/bundles/formrenderlibrarieswithoutreact")
    @Scripts.Render("~/bundles/formrendercomponents")
    @Scripts.Render("~/bundles/SharedComponents/Stages")
    @Scripts.Render("~/bundles/ManageV2");
 
    <script src="~/Styles/libraries/babel.min.js"></script>
    <script type="text/javascript" src="~/Scripts/lib/pageBreak/pageBreak.js"></script>
    <script src="~/Scripts/lib/handlebars.min.js"></script>
    <script src="~/Scripts/app/gieom.web.actioncentre.js"></script>
    <script type="text/javascript" src="~/Scripts/underscore.min.js"></script>
    <script src="~/Styles/libraries/antd.min.js"></script>
    <script src="~/Styles/libraries/react-i18next.js"></script>
    <script src="~/Styles/libraries/i18next.js"></script>
    <script src="~/Styles/libraries/i18next-browser-languagedetector.js"></script>
    <script src="~/Scripts/lib/EntityHierarchy_components/i18n.js"></script>
    <script src="~/Styles/libraries/redux.min.js"></script>
    <script src="~/Styles/libraries/reactredux.min.js"></script>

    <script type="text/javascript">
        var SystemParameters = JSON.parse('@Html.Raw(ViewBag.SystemParameters)');
        $("#HeaderFilterSearch").css("top", "-24px");

        function stageNameChanged(element) {
            $(element).parent().parent().parent().parent().parent().find(".stage_name_text").html($(element).val());
        }
        function toCamel(o) {
            var newO, origKey, newKey, value
            if (o instanceof Array) {
                return o.map(function (value) {
                    if (typeof value === "object") {
                        value = toCamel(value)
                    }
                    return value
                })
            } else {
                newO = {}
                for (origKey in o) {
                    if (o.hasOwnProperty(origKey)) {
                        newKey = (origKey.charAt(0).toUpperCase() + origKey.slice(1) || origKey).toString()
                        value = o[origKey]
                        if (value instanceof Array || (value !== null && value.constructor === Object)) {
                            value = toCamel(value)
                        }
                        newO[newKey] = value
                    }
                }
            }
            return newO
        }

                    var stageSubtractNumber = 0;


        function allowDrop(ev) {
            ev.preventDefault();
        }

        function drag(ev,element) {


            if ($(element).attr("draggable")) {
                ev.dataTransfer.setData("text", ev.target.id);
            }
            else {
                toastr.error("@Resources_Messages.Label_ThisStageIsFixedAndCannotBeMoved");
            }


        }



                    var dropDownArrowClick = function (e) {
                        var arrow_button = e.currentTarget;
                        var options_header = arrow_button.parentNode;
                        var options = $(e.currentTarget.parentNode.parentNode).find("ul");
                        if (options.css('display') === 'none') {
                            options.show();
                            arrow_button.classList.add('glyphicon-chevron-up');
                            arrow_button.classList.remove('glyphicon-chevron-down');
                            options_header.classList.add('opened');
                            options_header.classList.remove('closed');
                        } else {
                            options.hide();
                            arrow_button.classList.add('glyphicon-chevron-down');
                            arrow_button.classList.remove('glyphicon-chevron-up');
                            options_header.classList.add('closed');
                            options_header.classList.remove('opened');
                        }
                    };



                    function addStageMethod(stageType) {

                        var emptyStage = {
                            "Actions": {},
                            "StageName": "",
                            "isVisible": false,
                            "ApprovalMandatory": false,
                            "ReviewBy": "",
                            "IsMandatory": false,
                            "IsPinned": false,
                            "SamplingSize": 100,
                            "StageNumber": gm.stage.addedStageList().length + 1,
                            "JsonForm": "[]",
                            "StageType": stageType,
                            "FormGroup": ko.observableArray()
                        };



                        if (stageType == "") {
                            if (gm.stage.addedStageList().length > 0) {
                                var lastElementPosition = $(".list-item-header").length - 1;
                                var firstElementPosition = 0;


                                if ($(".list-item-header")[firstElementPosition].querySelector(".fixed") && gm.stage.addedStageList()[firstElementPosition].IsPinned) {

                                    gm.stage.addedStageList().splice((firstElementPosition + 1), 0, emptyStage);
                                    $($(".list-item")[firstElementPosition + 1]).find("*").attr('disabled', false);
                                    $($(".list-item")[firstElementPosition + 1]).find("*").css('pointer-events', 'all');

                                } else {


                                    if ($(".list-item-header")[lastElementPosition].querySelector(".fixed") && gm.stage.addedStageList()[lastElementPosition].IsPinned) {

                                        var buffer = gm.stage.addedStageList()[lastElementPosition];
                                        gm.stage.addedStageList()[lastElementPosition] = emptyStage;
                                        gm.stage.addedStageList.push(buffer);
                                        $($(".list-item")[lastElementPosition]).find("*").attr('disabled', false);
                                        $($(".list-item")[lastElementPosition]).find("*").css('pointer-events', 'all');
                                    }
                                    else {
                                        gm.stage.addedStageList.push(emptyStage);
                                        $($(".list-item")[lastElementPosition + 1]).find("*").attr('disabled', false);
                                        $($(".list-item")[lastElementPosition + 1]).find("*").css('pointer-events', 'all');
                                    }
                                }

                            } else {
                                gm.stage.addedStageList.push(emptyStage);
                            }
                        } else if (stageType == "first") {
                            gm.stage.addedStageList().splice(0, 0, emptyStage);
                        } else if (stageType == "last") {
                            gm.stage.addedStageList().push(emptyStage);
                        }
                          var hideStage = gm.stage.addedStageList().length - 1;

                        $("#stageFormGroup_" + hideStage + " .Hideclass").hide();


                        $("#numberOfStages").val(gm.stage.addedStageList().length - stageSubtractNumber > 0 ? gm.stage.addedStageList().length - stageSubtractNumber : 0);

                        gm.stage.addedStageList.valueHasMutated();

                        $("#approvalNotNeeded").prop("checked", false);
                        gm.stage.approvalNotNeeded(false);
                        //Re-trigger events applied to stage tiles

                        gm.actionSelect.init();

                        $(".dropDownArrow").off('click').on("click", dropDownArrowClick);

                        $(".delete").off('click').on("click",
                            function (e) {
                                var stageNumber = e.currentTarget.id.split('_')[1] - 1;

                                gm.stage.addedStageList().splice(stageNumber, 1);

                                gm.stage.addedStageList.valueHasMutated();


                                gm.stage.numberOfStages = gm.stage.addedStageList().length;
                                $("#numberOfStages").val(gm.stage.addedStageList().length - stageSubtractNumber > 0 ? gm.stage.addedStageList().length - stageSubtractNumber : 0);
                                if ($(".list-item").length > gm.stage.numberOfStages) {

                                    stageNumber++;
                                    $("#stagedrag_" + stageNumber).remove();

                                }
                                reorder();


                            });

                        $('.approvalCheck').off('click').on('click',
                            function (e) {
                                gm.stage.addedStageList()[e.currentTarget.attributes["id"].value.split('_')[1] - 1]
                                    .ApprovalMandatory =
                                    !(gm.stage.addedStageList()[e.currentTarget.attributes["id"].value.split('_')[1] - 1]
                                        .ApprovalMandatory);
                            });
                        $('.mandatoryCheck').off('click').on('click',
                            function (e) {

                                gm.stage.addedStageList()[e.currentTarget.attributes["id"].value.split('_')[1] - 1]
                                    .IsMandatory =
                                    !(gm.stage.addedStageList()[e.currentTarget.attributes["id"].value.split('_')[1] - 1]
                                        .IsMandatory);

                                if (gm.stage.addedStageList()[e.currentTarget.attributes["id"].value.split('_')[1] - 1]
                                    .IsMandatory) {
                                    $(this).parent().parent().find(".delete").hide();
                                } else {
                                    $(this).parent().parent().find(".delete").show();
                                }
                            });

                        reorder();
                    }






        function dragend(ev) {
            $(".drop-div").removeClass("drop-active");


        }

        function dragenter(ev, thiselement) {

            $(thiselement).addClass("drop-active");

        }


        function dragleave(ev, thiselement) {

            $(thiselement).removeClass("drop-active");

        }


        function disableDrop() {

            $(".drop-div .list-item").unwrap();
            var dropdiv = document.querySelector(".drop-div");
            var ref = document.getElementsByClassName("list-item");
            var cln = dropdiv.cloneNode();
            $(".drop-div").remove();
            for (var i = 0; i < ref.length; i++) {
                if ($(ref[i]).attr("draggable") == "false") {
                    if (i == 0) {

                        insertAfter(cln.cloneNode(), ref[i]);
                    }
                    if (i == (ref.length - 1)) {

                        insertBefore(cln.cloneNode(), ref[i]);
                    }
                }
                else {

                    insertAfter(cln.cloneNode(), ref[i]);
                    insertBefore(cln.cloneNode(), ref[i]);
                }

            }

        }

        function drop(ev) {
            ev.preventDefault();
            var data = ev.dataTransfer.getData("text");
            if (ev.target.nodeName == "DIV") {
                ev.target.appendChild(document.getElementById(data));

                toastr.success("@Resources_Messages.Alert_StageSwitched");
                reorder();
                setTimeout(function () { reorder(); }, 1000);


            }
            else
            {
                toastr.error("Please Drop Inside A Grey Box");
            }



        }


        var gm = gm || {};
        gm.clearStageData = function () {
            gm.stage.addedStageList = ko.observableArray();
            gm.stage.numberOfStages = ko.observable(0);
            gm.stage.addedActionList = ko.observableArray();
            gm.stage.editedStageNumber = ko.observable(0);
            gm.stage.editedFormGroupIndex = ko.observable(0);
            gm.stage.approvalNotNeeded = ko.observable(true);
            gm.stage.supervisorApproval = ko.observable(false);
        }
        gm.stage = function () {
                var addedStageList = ko.observableArray(),
                numberOfStages = ko.observable(0),
                addedActionList = ko.observableArray(),
                editedStageNumber = ko.observable(0),
                editedFormGroupIndex = ko.observable(0),
                approvalNotNeeded = ko.observable(true),
                supervisorApproval = ko.observable(false),
                reloadFormStagesDropdown = function() {

                      if($("#numberOfStages").length > 0) {
 $("#numberOfStages").val(gm.stage.addedStageList().length);
}

                    $(".formStagesUsers").empty();
                    for (i = 0; i < gm.stage.addedStageList().length; i++) {
                        for (j = 0; j < gm.stage.addedStageList()[i].FormGroup().length; j++) {
                            var approverArray = [];
                            $.each(gm.stage.addedStageList()[i].FormGroup()[j].Approvers,
                                function(index, item) {
                                    approverArray.push(item.id);
                                    //'stageForm_'+$parentContext.$index()+'_' +  ($index())
                                    $("#stageForm_" + i + "_" + j + " .formStagesUsers")
                                        .append('<option value="' + item.id + '">' + item.label + '</option>');
                                });
                            $("#stageForm_" + i + "_" + j + " .formStagesUsers").select2().val(approverArray)
                                .trigger("change");
                        }
                    }

                    $(".formStagesUsers").select2({
                        ajax: {
                            url: "@Url.Action("FetchUsersAndRoles", "Workflow")",
                            dataType: 'json',
                            delay: 250,
                            data: function(params) {
                                return {
                                    q: params.term, // search term
                                    page: params.page
                                };
                            },
                            processResults: function(data, page) {

                                return {
                                    results: data
                                };
                            },
                            cache: false
                        },
                        placeholder: "@Resources_Messages.Label_ClickToAssignUser",
                        escapeMarkup: function(markup) { return markup; }, // let our custom formatter work
                        minimumInputLength: 0,
                        theme: 'material',
                        templateResult: function(data) {

                            if (data.loading) return data.text; //Show loading text
                            var markup = '';
                            if (data.isUser) {
                                markup = '<option value="' +
                                    data.id +
                                    '">' +
                                    data.user.memberships[0].entity +
                                    "/" +
                                    data.user.memberships[0].department +
                                    "/" +
                                    data.user.memberships[0].role +
                                    "/" +
                                    data.user.profile.displayName +
                                    " : " +
                                    data.user.userName +
                                    '</option>';
                            } else {
                                markup = '<option value="' + data.id + '">' + data.label + '</option>';
                            }
                            return markup;
                        },
                        templateSelection: function(data) {
                            return data.label || data.text;
                        }
                    });


                        $('.formStagesUsers').unbind('select2:select');
                        $(".formStagesUsers").on("select2:select", function (e) {
                            gm.stage.addedStageList()[
                                    e.currentTarget.parentNode.parentNode.attributes["data-stageNumber"].value]
                                .FormGroup()[e.currentTarget.parentNode.parentNode.attributes["data-formIndex"].value]
                                .Approvers.push({
                                    "id": e.params.data.id,
                                    "label": e.params.data.label,
                                    "isUser": e.params.data.isUser
                                });
                        });

                        $('.formStagesUsers').unbind('select2:unselect');
                        $(".formStagesUsers").on("select2:unselect", function (e) {
                            var currentFormApprovers =
                                gm.stage.addedStageList()[
                                        e.currentTarget.parentNode.parentNode.attributes["data-stageNumber"].value]
                                    .FormGroup()[e.currentTarget.parentNode.parentNode.attributes["data-formIndex"]
                                        .value]
                                    .Approvers;
                            //removing selected object from array
                            for (var i = 0; i < currentFormApprovers.length; i++) {
                                if (currentFormApprovers[i].id == e.params.data.id) {
                                    currentFormApprovers.splice(i, 1);
                                    break;
                                }
                            }
                        });

                },
                editStageForm = function(stageData, childIndex) {
                    const $modal = $("#formStagesModal");
                    const data = stageData.FormGroup()[childIndex()];

                    $('.formTitle', $modal).text(data.Header);
                    $modal.modal("show");
                    fb.actions.setData(data.JsonForm);

                    $("#formDesignerArea").addClass("disabledTab");
                    editedStageNumber(stageData.StageNumber);
                    editedFormGroupIndex(childIndex());
                },
                removeStageForm = function(stageData, selectedForm) {
                    gm.stage.addedStageList()[stageData.StageNumber - 1].FormGroup.remove(selectedForm);

                },
                addFormGroup = function(stageData) {
                    stageData.FormGroup.push({ "JsonForm": "[]", "Approvers": [], "Header": "" });
                    reloadFormStagesDropdown();
                    setFixed();
                    var hideStage = gm.stage.addedStageList().length - 1;
                        $("#stageFormGroup_" + hideStage + " .Hideclass").hide();
                };


            //Method for loading previously assigned stages from server
             loadStages = function() {

                 var objectArray = Model;


                 if (objectArray.FormStages) {
                     var stageArray = JSON.parse(objectArray.FormStages);
                 } else {
                      var stageArray = JSON.parse(objectArray.Stages);
                 }

                 supervisorApproval(objectArray.SupervisorApproval);
                 //gm.stage.addedStageList().length = 0;
                    if (stageArray) {
                        for (var i = 0; i < stageArray.length; i++) {
                            //stageArray[i].StageNumber=i+1;
                            if (i > 0)
                                stageArray[i].isVisible = false;
                            else
                                stageArray[i].isVisible = true;
                            stageArray[i].FormGroup = ko.observableArray(stageArray[i].FormGroup);
                            gm.stage.addedStageList.push(stageArray[i]);

                        }
                    }

                 if (gm.stage.addedStageList().length > 0)
                        approvalNotNeeded(false);
                    gm.stage.addedStageList.valueHasMutated();

                    gm.actionSelect.init();




            };
            return {
                loadStages: loadStages,
                addedStageList: addedStageList,
                numberOfStages: numberOfStages,
                approvalNotNeeded: approvalNotNeeded,
                supervisorApproval: supervisorApproval,
                editStageForm: editStageForm,
                editedStageNumber: editedStageNumber,
                editedFormGroupIndex: editedFormGroupIndex,
                addFormGroup: addFormGroup,
                removeStageForm: removeStageForm,
                reloadFormStagesDropdown: reloadFormStagesDropdown
            };
        }();

        function docReady() {
            gm.stage.loadStages();
            $(".stage_name_input").attr("disabled", false);
            $("[id^=Reject]").attr('disabled', true);
            if (gm.stage.addedStageList().length > 0) {
                $(".noStagesAddedDiv").hide();
                if (gm.stage.addedStageList()[0].StageType == "first") {
                    stageSubtractNumber++;
                }
                if (gm.stage.addedStageList()[gm.stage.addedStageList().length - 1].StageType == "last") {
                    stageSubtractNumber++;
                }
            }
            else {
                $("#saveActionCenterBtn").hide();
                $(".noStagesAddedDiv").show();
            }
            gm.stage.numberOfStages = gm.stage.addedStageList().length - stageSubtractNumber;
            ko.cleanNode(stageWrapper);
            ko.applyBindings(gm.stage, stageWrapper);
            gm.stage.reloadFormStagesDropdown();

            manageFixed();


            var dropDownArrowClick = function(e) {
                var arrow_button = e.currentTarget;
                var options_header = arrow_button.parentNode;
                var options = $(e.currentTarget.parentNode.parentNode).find("ul");
                if (options.css('display') === 'none') {
                    options.show();
                    arrow_button.classList.add('glyphicon-chevron-up');
                    arrow_button.classList.remove('glyphicon-chevron-down');
                    options_header.classList.add('opened');
                    options_header.classList.remove('closed');
                } else {
                    options.hide();
                    arrow_button.classList.add('glyphicon-chevron-down');
                    arrow_button.classList.remove('glyphicon-chevron-up');
                    options_header.classList.add('closed');
                    options_header.classList.remove('opened');
                }

                if (gm.stage.addedStageList().length > 0) {
                    if (gm.stage.addedStageList()[0].StageType == "first") {
                       // $("#stagedrag_1 *").attr("disabled", true);
                       // $("#stagedrag_1 .select2-selection__choice__remove").hide();
                       // $("#stagedrag_1 .fa.fa-close.cursor").hide();
                        $("#formStagesModal > div > div > div.modal-header > div:nth-child(1) > button").on('click', function () {
                            $("#btnAddtoFormStage").show();
                        });

                        $("#stagedrag_1 .glyphicon.glyphicon-pencil").on('click', function () {
                            $("#btnAddtoFormStage").hide();
                        });




                    }

                    if (gm.stage.addedStageList()[gm.stage.addedStageList().length - 1].StageType == "last") {
                      //  $("#stagedrag_" + gm.stage.addedStageList().length + " *").attr("disabled", true);
                      //  $("#stagedrag_" + gm.stage.addedStageList().length + " .select2-selection__choice__remove").hide();
                      //  $("#stagedrag_" + gm.stage.addedStageList().length + " .fa.fa-close.cursor").hide();

                        $("#formStagesModal > div > div > div.modal-header > div:nth-child(1) > button").on('click', function () {
                            $("#btnAddtoFormStage").show();
                        });

                        $("#stagedrag_" + gm.stage.addedStageList().length + " .glyphicon.glyphicon-pencil").on('click', function () {
                            $("#btnAddtoFormStage").hide();
                        });
                    }
                }

                //if ($("ul.options")[0].style.display != "none" && gm.stage.addedStageList()[0].StageType =='first') {
                //    var heightoful = $($("ul.options")[0]).height();
                //    $("#stageWrapper > div > div.new-design-theme.workflow-stages-card")[0].style.top = "calc(15vh + " + heightoful + "px)";
                //}

                //if ($("ul.options")[0].style.display == "none" && gm.stage.addedStageList()[0].StageType == 'first') {
                //    $("#stageWrapper > div > div.new-design-theme.workflow-stages-card")[0].style.top = "15vh";
                //}
            };

            $('.approvalCheck').on('click',
                function(e) {
                    gm.stage.addedStageList()[e.currentTarget.attributes["id"].value.split('_')[1] - 1]
                        .ApprovalMandatory =
                        !(gm.stage.addedStageList()[e.currentTarget.attributes["id"].value.split('_')[1] - 1]
                            .ApprovalMandatory);
                });

            $('.mandatoryCheck').on('click',
                function (e) {

                    gm.stage.addedStageList()[e.currentTarget.attributes["id"].value.split('_')[1] - 1]
                        .IsMandatory =
                        !(gm.stage.addedStageList()[e.currentTarget.attributes["id"].value.split('_')[1] - 1]
                            .IsMandatory);

                    if (gm.stage.addedStageList()[e.currentTarget.attributes["id"].value.split('_')[1] - 1]
                        .IsMandatory) {
                        $(this).parent().parent().find(".delete").hide();
                    } else {
                        $(this).parent().parent().find(".delete").show();
                    }
                });

            //Not allowing keyboard changes for editing number
            $("#numberOfStages").keypress(function(evt) {
                evt.preventDefault();
                toastr.error("@Resources_Messages.Alert_PleaseUseTheNumberCounterToAddRemoveStages");
            });

            //Save method
            $("#saveForm").click(function(e) {
                e.preventDefault();
                var proceedFlag = "OK";
                $.each(gm.stage.addedStageList(),
                    function(index, item) {
                        if (!item.StageName) {
                            proceedFlag = "Stage Name_" + (index + 1);
                        } else if (item.ReviewBy != "" && isNaN(item.ReviewBy)) {
                            proceedFlag = "Review By " + (index + 1);
                        } else if (Object.keys(item.Actions).length === 0 && item.Actions.constructor === Object) {
                            proceedFlag = "Actions_" + (index + 1);
                        }
                        //else if (item.FormGroup().length >0  && (!item.FormGroup()[0].Approvers || item.FormGroup()[0].Approvers.length == 0)) {
                        //    proceedFlag = "Approvers_" + (index + 1);
                        //}
                        else {
                            if (item.ReviewBy == "") {
                                item.ReviewBy = 0;
                            }
                        }
                    });

                if (proceedFlag == "OK") {
                    $(this).prop('disabled', true);
                    var endPointUrl = "@Url.Action("UpdateStages", "Workflow")?objectId="+Model.Id;
                    var stageData = new FormData();
                    stageData.append("Stages", ko.toJSON(gm.stage.addedStageList()));
                    stageData.append("SupervisorApproval", $('#supervisorApproval').prop('checked'));

                    $.ajax({
                        url: endPointUrl,
                        type: 'POST',
                        cache: false,
                        async: false,
                        dataType: 'json',
                        contentType: false,
                        processData: false,
                        data: stageData,
                        success: function(data) {
                            toastr.options = {
                                "onHidden": function() {
                                    window.location.href =
                                        "@Url.Action("Attestations", "Workflow")?workflowId="+Model.Id
                                },
                                "timeOut": 1000
                            };
                            toastr.success("@Resources_Messages.Alert_StagesDetailsSaved");
                        },
                        error: function(error) {
                            JL().error(error);
                            console.log("error2");
                            toastr.error("@Resources_Messages.Error_InternalErrorRequestNotCompleted");
                            $(this).prop('disabled', false);
                        }
                    });
                } else {
                    var errorString = "@Resources_Messages.FormFieldEmpty";
                    toastr.error(errorString.replace("{0}", "@Resources_Messages.Label_Stage")
                        .replace("{1}", proceedFlag.split('_')[1]).replace("{2}", proceedFlag.split('_')[0]));
                }
            });

            $("#saveClick").click(function(e) {
                e.preventDefault();
                var proceedFlag = "OK";
                $.each(gm.stage.addedStageList(),
                    function(index, item) {
                        if (!item.StageName) {
                            proceedFlag = "Stage Name_" + (index + 1);
                        } else if (item.ReviewBy != "" && isNaN(item.ReviewBy)) {
                            proceedFlag = "Review By " + (index + 1);
                        } else if (Object.keys(item.Actions).length === 0 && item.Actions.constructor === Object) {
                            proceedFlag = "Actions_" + (index + 1);
                        }
                        //else if (item.FormGroup().length == 0 || !item.FormGroup()[0].Approvers || item.FormGroup[0].Approvers.length==0) {
                        //    proceedFlag="Approvers_"+(index+1);
                      //}
                        else {
                            if (item.ReviewBy == "") {
                                item.ReviewBy = 0;
                            }
                        }
           });

                if (proceedFlag == "OK") {
                    $(this).prop('disabled', true);
                    var endPointUrl = "@Url.Action("UpdateStages", "Workflow")?objectId="+Model.Id;
                    var stageData = new FormData();
                    stageData.append("Stages", ko.toJSON(gm.stage.addedStageList()));
                    stageData.append("SupervisResources_MessagesrError_FormFieldEmptyError_FormFieldEmptyError_FormFieldEmptypproval", $('#supervisorApproval').prop('checked'));
                    $.ajax({
                        url: endPointUrl,
                        type: 'POST',
                        cache: false,
                        async: false,
                        dataType: 'json',
                        contentType: false,
                        processData: false,
                        data: stageData,
                        success: function(data) {
                            toastr.options = {
                                "onHidden": function() {
                                    window.location.href = "@ViewBag.CancelUrl"
                                },
                                "timeOut": 4000
                            };
                            toastr.success("@Resources_Messages.Alert_StagesDetailsSaved");
                        },
                        error: function(error) {
                            JL().error(error);
                            console.log("error2");
                            toastr.error("@Resources_Messages.Error_InternalErrorRequestNotCompleted");
                            $(this).prop('disabled', false);
                        }
                    });
                } else {
                    var errorString = "@Resources_Messages.FormFieldEmpty";
                    toastr.error(errorString.replace("{0}", "@Resources_Messages.Label_Stage")
                        .replace("{1}", proceedFlag.split('_')[1]).replace("{2}", proceedFlag.split('_')[0]));
                }
            });







            $("#plus").click(function () {
                addStageMethod("");

            });




            //$("#plus").click(function() {
            //    var emptyStage = {
            //        "Actions": {},
            //        "StageName": "",
            //        "isVisible": false,
            //        "ApprovalMandatory": false,
            //        "ReviewBy": "",
            //        "IsMandatory": false,
            //        "IsPinned": false,
            //        "SamplingSize": 100,
            //        "StageNumber": gm.stage.addedStageList().length + 1,
            //        "JsonForm": "[]",
            //        "FormGroup": ko.observableArray()
            //    };


            //    if (gm.stage.addedStageList().length > 0) {
            //        var lastElementPosition = $(".list-item-header").length - 1;
            //        if ($(".list-item-header")[lastElementPosition].querySelector(".fixed")) {

            //            var buffer = gm.stage.addedStageList()[lastElementPosition];
            //            gm.stage.addedStageList()[lastElementPosition] = emptyStage;
            //            gm.stage.addedStageList.push(buffer);
            //        }
            //        else {
            //            gm.stage.addedStageList.push(emptyStage);
            //        }
            //    } else {
            //        gm.stage.addedStageList.push(emptyStage);
            //    }

            //    $("#numberOfStages").val(gm.stage.addedStageList().length - stageSubtractNumber);

            //    gm.stage.addedStageList.valueHasMutated();

            //    $("#approvalNotNeeded").prop("checked", false);
            //    gm.stage.approvalNotNeeded(false);
            //    //Re-trigger events applied to stage tiles

            //    gm.actionSelect.init();

            //    $(".dropDownArrow").off('click').on("click", dropDownArrowClick);

            //    $(".delete").off('click').on("click",
            //        function(e) {
            //            var stageNumber = e.currentTarget.id.split('_')[1] - 1;

            //            gm.stage.addedStageList().splice(stageNumber, 1);

            //            gm.stage.addedStageList.valueHasMutated();


            //            gm.stage.numberOfStages = gm.stage.addedStageList().length;
            //            $("#numberOfStages").val(gm.stage.numberOfStages - stageSubtractNumber);
            //            if ($(".list-item").length > gm.stage.numberOfStages) {

            //                stageNumber++;
            //                $("#stagedrag_" + stageNumber).remove();

            //            }
            //            reorder();


            //        });

            //    $('.approvalCheck').off('click').on('click',
            //        function(e) {
            //            gm.stage.addedStageList()[e.currentTarget.attributes["id"].value.split('_')[1] - 1]
            //                .ApprovalMandatory =
            //                !(gm.stage.addedStageList()[e.currentTarget.attributes["id"].value.split('_')[1] - 1]
            //                    .ApprovalMandatory);
            //        });

            //    $('.mandatoryCheck').off('click').on('click',
            //        function (e) {

            //            gm.stage.addedStageList()[e.currentTarget.attributes["id"].value.split('_')[1] - 1]
            //                .IsMandatory =
            //                !(gm.stage.addedStageList()[e.currentTarget.attributes["id"].value.split('_')[1] - 1]
            //                    .IsMandatory);

            //            if (gm.stage.addedStageList()[e.currentTarget.attributes["id"].value.split('_')[1] - 1]
            //                .IsMandatory) {
            //                $(this).parent().parent().find(".delete").hide();
            //            } else {
            //                $(this).parent().parent().find(".delete").show();
            //            }
            //        });

            //    reorder();

            //});

            $("#minus").click(function() {
                if ($("#numberOfStages").val() >= 1) {
                    if (gm.stage.addedStageList()[gm.stage.addedStageList().length - 1].IsPinned) {
                        gm.stage.addedStageList.remove(gm.stage.addedStageList()[gm.stage.addedStageList().length - 2]);
                    } else {
                       gm.stage.addedStageList.remove(gm.stage.addedStageList()[gm.stage.addedStageList().length - 1]);
                    }

                    $("#numberOfStages").val(gm.stage.addedStageList().length - stageSubtractNumber);
                    gm.stage.addedStageList.valueHasMutated();
                    if (gm.stage.addedStageList().length == 0) gm.stage.approvalNotNeeded(true);


                    reorder();
                }
            });

            $("#approvalNotNeeded").change(function () {
                while (gm.stage.addedStageList().length > stageSubtractNumber)
                    gm.stage.addedStageList.remove(gm.stage.addedStageList()[1]);
                $("#numberOfStages").val(gm.stage.addedStageList().length - stageSubtractNumber > 0 ? gm.stage.addedStageList().length - stageSubtractNumber : 0);
                gm.stage.addedStageList.valueHasMutated();
            });

            $(".dropDownArrow").on("click", dropDownArrowClick);

            $(".delete").on("click",
                function (e) {

                    var stageNumber = e.currentTarget.id.split('_')[1] - 1;

                    gm.stage.addedStageList().splice(stageNumber, 1);

                    gm.stage.addedStageList.valueHasMutated();


                    gm.stage.numberOfStages = gm.stage.addedStageList().length;
                    $("#numberOfStages").val(gm.stage.numberOfStages - stageSubtractNumber);
                    if ($(".list-item").length > gm.stage.numberOfStages) {

                        stageNumber++;
                        $("#stagedrag_" + stageNumber).remove();

                    }
                    reorder();


                });
            setFixed();


            if (gm.stage.addedStageList().length > 0) {
                if (gm.stage.addedStageList()[0].StageType == "first") {
                    //$("#stagedrag_1 *").attr("disabled", true);
                    //$("#stagedrag_1 .select2-selection__choice__remove").hide();
                    //$("#stagedrag_1 .fa.fa-close.cursor").hide();


                }

                if (gm.stage.addedStageList()[gm.stage.addedStageList().length - 1].StageType == "last") {
                    //$("#stagedrag_" + gm.stage.addedStageList().length + " *").attr("disabled", true);
                    //$("#stagedrag_" + gm.stage.addedStageList().length + " .select2-selection__choice__remove").hide();
                    //$("#stagedrag_" + gm.stage.addedStageList().length + " .fa.fa-close.cursor").hide();


                }
            }
            if ($("#supervisorApproval").prop("checked") == false) {

                $("#stageWrapper > div > div.workflow-stages-card.supervisor").hide();
            }

        }

        function save(redirectTo, showToast) {
            var proceedFlag = "OK";
            $.each(gm.stage.addedStageList(),
                function(index, item) {
                    if (!item.StageName) {
                        proceedFlag = "Stage Name_" + (index + 1);
                    } else if (item.ReviewBy != "" && isNaN(item.ReviewBy)) {
                        proceedFlag = "Review By " + (index + 1);
                    } else if (Object.keys(item.Actions).length === 0 && item.Actions.constructor === Object) {
                        proceedFlag = "Actions_" + (index + 1);
                    }
                    //else if (item.FormGroup().length >0  && (!item.FormGroup()[0].Approvers || item.FormGroup()[0].Approvers.length == 0)) {
                    //    proceedFlag = "Approvers_" + (index + 1);
                    //}
                    else {
                        if (item.ReviewBy == "") {
                            item.ReviewBy = 0;
                        }
                    }
                });

            if (proceedFlag == "OK") {
                $(this).prop('disabled', true);
                var endPointUrl = "@Url.Action("UpdateStages", "Workflow")?objectId="+Model.Id;
                var stageData = new FormData();
                stageData.append("Stages", ko.toJSON(gm.stage.addedStageList()));
                stageData.append("SupervisorApproval", $('#supervisorApproval').prop('checked'));
                $.ajax({
                    url: endPointUrl,
                    type: 'POST',
                    cache: false,
                    async: false,
                    dataType: 'json',
                    contentType: false,
                    processData: false,
                    data: stageData,
                    success: function(data) {
                        if (!showToast) {
                            window.location.href = redirectTo;
                        }
                        else {
                            toastr.options = {
                                "onHidden": function() {
                                    window.location.href = redirectTo
                                },
                                "timeOut": 1000
                            };

                            toastr.success("@Resources_Messages.Alert_StagesDetailsSaved");
                        }

                    },
                    error: function(error) {
                        JL().error(error);
                        toastr.error("@Resources_Messages.Error_InternalErrorRequestNotCompleted");
                        $(this).prop('disabled', false);
                    }
                });
            } else {
                var errorString = "@Resources_Messages.FormFieldEmpty";
                toastr.error(errorString.replace("{0}", "@Resources_Messages.Label_Stage")
                    .replace("{1}", proceedFlag.split('_')[1]).replace("{2}", proceedFlag.split('_')[0]));
            }
        }


        //reordering stages

        function reorder() {

            var dropDownArrowClick = function (e) {
                var arrow_button = e.currentTarget;
                var options_header = arrow_button.parentNode;
                var options = $(e.currentTarget.parentNode.parentNode).find("ul");
                if (options.css('display') === 'none') {
                    options.show();
                    arrow_button.classList.add('glyphicon-chevron-up');
                    arrow_button.classList.remove('glyphicon-chevron-down');
                    options_header.classList.add('opened');
                    options_header.classList.remove('closed');
                } else {
                    options.hide();
                    arrow_button.classList.add('glyphicon-chevron-down');
                    arrow_button.classList.remove('glyphicon-chevron-up');
                    options_header.classList.add('closed');
                    options_header.classList.remove('opened');
                }
                if (gm.stage.addedStageList().length > 0) {
                    if (gm.stage.addedStageList()[0].StageType == "first") {
                       // $("#stagedrag_1 *").attr("disabled", true);
                        //$("#stagedrag_1 .select2-selection__choice__remove").hide();
                        //$("#stagedrag_1 .fa.fa-close.cursor").hide();


                    }

                    if (gm.stage.addedStageList()[gm.stage.addedStageList().length - 1].StageType == "last") {
                       // $("#stagedrag_" + gm.stage.addedStageList().length + " *").attr("disabled", true);
                       // $("#stagedrag_" + gm.stage.addedStageList().length + " .select2-selection__choice__remove").hide();
                       // $("#stagedrag_" + gm.stage.addedStageList().length + " .fa.fa-close.cursor").hide();


                    }
                }
                //if ($("ul.options")[0].style.display != "none" && gm.stage.addedStageList()[0].StageType == 'first') {
                //    var heightoful = $($("ul.options")[0]).height();
                //    $("#stageWrapper > div > div.new-design-theme.workflow-stages-card")[0].style.top = "calc(15vh + " + heightoful + "px)";
                //}

                //if ($("ul.options")[0].style.display == "none" && gm.stage.addedStageList()[0].StageType == 'first') {
                //    $("#stageWrapper > div > div.new-design-theme.workflow-stages-card")[0].style.top = "15vh";
                //}
            };


            var bufferArray = [];
            var listitem = $(".list-item");
            for (var i = 0; i < listitem.length; i++) {
                bufferArray[i] = gm.stage.addedStageList()[i] ;

            }

            for (var i = 0; i < listitem.length; i++) {
                gm.stage.addedStageList()[i] = bufferArray[listitem[i].attributes["id"].value.split('_')[1] - 1];


            }

            for (var i = 0; i < listitem.length; i++) {
                gm.stage.addedStageList()[i].StageNumber = i + 1;

            }


           // #stagedrag_2 list-item-header div span.highlight.bold.stageTitleElement


            //call these in the end
            gm.stage.addedStageList.valueHasMutated();
            $(".dropDownArrow").off('click').on("click", dropDownArrowClick);
            disableDrop();
            manageFixed();
        }

        function manageFixed() {

            for (var i = 1; i < $(".list-item .fix").length - 1; i++) {

                $(".list-item .fix")[i].style.display = "none";
                $(".list-item .mandatoryCheck")[i].style.visibility = "hidden";
                $(".list-item .mandatoryCheck_label")[i].style.visibility = "hidden";
            }

            if (gm.stage.addedStageList().length > 0) {

                if (gm.stage.addedStageList()[0].StageType != 'first') {
                    $(".list-item .mandatoryCheck_label")[0].style.visibility = "hidden";
                    $("#stagedrag_1").css({ "position": "static" });
                }

                if (gm.stage.addedStageList()[gm.stage.addedStageList().length - 1].StageType != 'last') {
                    $(".list-item .mandatoryCheck_label")[$(".list-item .fix").length - 1].style.visibility = "hidden";
                }

            }
            var lastElementPosition = $(".list-item-header").length - 1;

            if ($(".list-item-header")[0]) {
                $(".list-item-header")[0].querySelector(".fix").style.display = "block";
            }

            if ($(".list-item-header")[lastElementPosition]) {
                $(".list-item-header")[lastElementPosition].querySelector(".fix").style.display = "block";
                }

        }

        function setFixed() {



            for (let i = 0; i < gm.stage.addedStageList().length; i++) {
                if (gm.stage.addedStageList()[i].IsPinned) {
                    $("#stageAllIsPinned_" + (i + 1)).click();
                    $("#stageAllIsPinned_" + (i + 1)).addClass("fixStable");

                }
                if (gm.stage.addedStageList()[i].IsMandatory) {
                    $($(".list-item")[i]).find(".select2-selection__choice__remove").hide();
                    $($(".list-item")[i]).find(".select2-search__field").remove();

                    $("#deleteStage_" + (i + 1)).hide();


                }
            }
        }


        function fixClick(element) {


            if ($(element).hasClass("fixStable") == true) {
                return false;
            }

            $(element).toggleClass("fixed");
            $(".fix").parent().parent().attr("draggable", "true");
            $(".fixed").parent().parent().attr("draggable", "false");
            if ($(element).hasClass("fixed")) {
                gm.stage.addedStageList()[element.id.split("_")[1] - 1]
                    .IsPinned = true;

                //check mandatorybox
                $(element).parent().find('.mandatoryCheck').prop("checked", true);
                //disabled mandatory box
                $(element).parent().find('.mandatoryCheck').prop("disabled", true);
                gm.stage.addedStageList()[element.id.split("_")[1] - 1]
                    .IsMandatory = true;


                //hide delete button
                $(element).parent().find('.delete').hide();
            } else {
                gm.stage.addedStageList()[element.id.split("_")[1] - 1]
                    .IsPinned = false;
                //enable mandatory box
                $(element).parent().find('.mandatoryCheck').prop("disabled", false);
                $(element).parent().find('.mandatoryCheck').prop("checked", false);
                gm.stage.addedStageList()[element.id.split("_")[1] - 1]
                    .IsMandatory = false;

                //show delete button
               // $(element).parent().find('.delete').show();

            }
            disableDrop();
        }

        function insertAfter(el, referenceNode) {
            referenceNode.parentNode.insertBefore(el, referenceNode.nextSibling);
        }


        function insertBefore(el, referenceNode) {
            referenceNode.parentNode.insertBefore(el, referenceNode);
        }






            //reordering stages

        $.material.checkbox = function(selector) {
            // Add fake-checkbox to material checkboxes
            $((selector) ? selector : this.options.checkboxElements)
                .filter(":notmdproc")
                .filter(function() { //added this filter to skip checkboxes that were already initialized
                    return $(this).parent().find(".check").length === 0;
                })
                .data("mdproc", true)
                .after("<span class='checkbox-material'><span class='check'></span></span>");
        };

    $("#controlsListModal > div > div.LayoutPageHeader > div > div.tabs-list > ul > li:first-child").addClass("active");
    $("#myModal > div > div.LayoutPageHeader > div > div.tabs-list > ul > li:first-child").addClass("active");
           
    $("#selfAttestationList").parent().hide();
    $(".edashboard-nav-caption").css("min-width", "");
    $("#btn_left").prop("disabled", true);
    var Model;
    var UrlSettings = {
    stageEnduser: '@Url.Action("GetDraftTaskById", "ActionCentre")',
    stageEnduser2: '@Url.Action("StagesEndUser", "Workflow")',
    saveSubmitUrl: '@Url.Action("SaveSubmitForm", "ActionCentre")',
    createTaskFromWorkflowsList: '@Url.Action("CreateTaskFromWorkflowsList", "ActionCentre")',
    amendmentHistory: '@Url.Action("GetAmendmentsHistory", "ActionCentre")'
    };
    var stagedatahtml = $("#stage_container").html();
    $("#stage_container").html("");

    function tabswitchStages() {
    $("#controlsListModal > div > div.LayoutPageHeader > div > div.control-panel > a:nth-child(3)").attr("disabled",false);
    $("#controlsListModal > div > div.LayoutPageHeader > div > div.control-panel > a:nth-child(4)").attr("disabled", true);
    $(".form-tab").hide();
    $(".stages-tab").show();
    $("#controlsListModal > div > div.LayoutPageHeader > div > div.tabs-list > ul > li:nth-child(2)").addClass("active");
    $("#controlsListModal > div > div.LayoutPageHeader > div > div.tabs-list > ul > li:nth-child(1)").removeClass("active");
    if (allowAddingStages) {
    $(".new-design-theme.workflow-stages-card").removeClass("hidden");
    } else {
    $(".new-design-theme.workflow-stages-card").addClass("hidden");
    }
    }

    function tabswitchForm() {
    $("#controlsListModal > div > div.LayoutPageHeader > div > div.control-panel > a:nth-child(3)").attr("disabled", true);
    $("#controlsListModal > div > div.LayoutPageHeader > div > div.control-panel > a:nth-child(4)").attr("disabled", false);
    $(".form-tab").show();
    $(".stages-tab").hide();
    $("#controlsListModal > div > div.LayoutPageHeader > div > div.tabs-list > ul > li:nth-child(1)").addClass("active");
    $("#controlsListModal > div > div.LayoutPageHeader > div > div.tabs-list > ul > li:nth-child(2)").removeClass("active");
    }



    function setImageUrl(selectedValue) {

    $.ajax({
    type: "GET",
    cache: false,
    url:"@Url.Action("GetProcessMapPublish", "Workflow")" + "?processId=" + selectedValue,
    contentType: 'application/json',
    success: function (response) {

    $("#processUrl").parent().show();

    var url = response.url;
    $("#processUrl").attr("href", url);
    $("#processUrl").parent().children().last().text(response.status+"("+response.version+")");

    //$("<b />", { text: response.version }).appendTo("#version");

    //$("#versionNumber").html(response.version);
    },
    error: function (error) {

    toastr.error("@Resources_Messages.Error_ErrorLoadingData");
    }
    });
        }
        function ActionValues() {
    $.ajax({
        data: { 'taskId': gm.actioncentre.selectedRow().taskId() },
        url: '@Url.Action("GetActionLinkedDetails", "MetricsLibrary")',
        type: 'GET',
        async: true,
        success: function (Response) {
            var DivlinkedActionDetails = document.getElementById('ActionValue');
            var NewActionValues = document.querySelectorAll('.NewActionValue');

            NewActionValues.forEach(function (div) {
                div.style.display = 'none';
            });

            if (DivlinkedActionDetails != null) {
                DivlinkedActionDetails.innerHTML = "";

                if (Response) {
                    if (Response.Item1 && Array.isArray(Response.Item1)) {
                        Response.Item1.forEach(function (subItem) {
                            for (var key in subItem) {
                                if (subItem.hasOwnProperty(key)) {
                                    var itemKey = key;
                                    var itemValue = subItem[key];

                                    DivlinkedActionDetails.innerHTML +=
                                        '<div class="form-group"><label>' + itemKey +
                                        ':</label><span class="show amendmentFeild">' +
                                        itemValue + '</span> <div class="printTextBox" style="display: none;">' +
                                        itemValue + '</div></div>';
                                }
                            }
                        });
                    }


                    if (Response.Item2 && Array.isArray(Response.Item2) && Response.Item2.length > 0) {
                        var fileItemsHTML = Response.Item2.map(function (fileItem) {
                            var fileDownloadUrl = 'ActionCentre/DownloadPdf/?fileId=' + fileItem.fileId;
                            return '<tr>' +
                                '<td>' + fileItem.file_name + '</td>' +
                                '<td class="cursor">' +
                                '<a href="' + fileDownloadUrl + '" download="' + fileItem.file_name + '" title="Download">' +
                                '<span class="glyphicon glyphicon-download-alt" style="font-size: 10px;"></span>' +
                                '</a>' +
                                '</td>' +
                                '</tr>';
                        }).join('');

                        DivlinkedActionDetails.innerHTML +=
                            '<div class="form-group">' +
                            '<label>Supporting Document(s)</label>' +
                            '<table class="table table-striped table-no-bordered table-hover table-scroll-tbody">' +
                            '<tbody style="display: block; max-height: 185px; overflow-y: auto;">' +
                            fileItemsHTML +
                            '</tbody>' +
                            '</table>' +
                            '</div>';
                    }

                    DivlinkedActionDetails.style.display = 'inline-block';
                } else {
                    NewActionValues.forEach(function (div) {
                        div.style.display = 'inline-block';
                    });
                }
            }
        },
        error: function (error) {
            JL().error(error);
        }
    });
}

        function loadFeildHistoryPage() {
            var wfCat = gm.actioncentre.selectedRow().workflowCategory();
            var newIsReview = wfCat == "VR" || wfCat == "BIR" || wfCat == "BCR" || wfCat=="VRR";
            let type = newIsReview ? "GET" : "POST"
            let payload = newIsReview ? ({ 'taskId': gm.actioncentre.selectedRow().taskId() })
                          : ko.toJSON({ 'taskId': gm.actioncentre.selectedRow().taskId() });
            let url = newIsReview ? '@Url.Action("GetHistoryByTaskId", "History")' : '@Url.Action("GetSummaryOfChanges", "ActionCentre")';
            $.ajax({
                  type:type,
                  cache: false,
                  data: payload,
                  url:url,
                  contentType: 'application/json',
                  success: function (response) {

                      for (let i = 0; i < response.length; i++) {

                          //response[i].time = convertDateFormat(response[i].time.split("T")[0]) + " &nbsp;" + response[i].time.split("T")[1].split(".")[0];
                          response[i].time = getISTDateTime(response[i].time);
                          if (newIsReview) {
                              document.getElementById("vendor_refferenceNumber").style.display = "table-cell"
                              document.getElementById("vendor_tabName").style.display = "table-cell"
                              if (response[i].oldValue == null) {
                                  response[i].oldValue = "";
                              }

                              if (response[i].newValue == null) {
                                  response[i].newValue = "";
                              }
                              if (response[i].userName == null) {
                                  response[i].userName = "";
                              }
                              if (response[i].time == null) {
                                  response[i].time = "";
                              }
                              if (response[i].label == null) {
                                  response[i].label = "";
                              }
                              if (response[i].ReffrenceNo == null) {
                                  response[i].ReffrenceNo = "";
                              }

                              $("#fieldhistorytable").
                                  append("<tr><td>" + response[i].name + "</td><td>" +
                                      response[i].oldValue + "</td><td>" +
                                      response[i].newValue + "</td><td>" +
                                      response[i].userName + "</td><td>" +
                                      response[i].time + "</td><td>" +
                                       response[i].label + "</td><td>" +
                                      response[i].ReffrenceNo + "</td></tr>");

                          }
                          else {
                              if (response[i].label != null) {
                                  if (response[i].comment == null) {

                                      if (response[i].oldValue == null) {
                                          response[i].oldValue = "";
                                      }

                                      if (response[i].newValue == null) {
                                          response[i].newValue = "";
                                      }
                                      if (response[i].userName == null) {
                                          response[i].userName = "";
                                      }
                                      //if ((response[i].label == "Month" || response[i].label.includes("Date")) && response[i].newValue != "") {
                                      //    response[i].newValue = convertDateFormat(response[i].newValue);
                                      //}
                                      //if ((response[i].label == "Month" || response[i].label.includes("Date")) && response[i].oldValue != "") {
                                      //    response[i].oldValue = convertDateFormat(response[i].oldValue);
                                      //}
                                      $("#fieldhistorytable").append("<tr><td>" + response[i].label + "</td><td>" + response[i].oldValue + "</td><td>" + response[i].newValue + "</td><td>" + response[i].userName + "</td><td>" + response[i].time + "</td></tr>");
                                  }
                                  else {

                                      if (response[i].userName == null) {
                                          response[i].userName = "";
                                      }

                                      $("#fieldhistorytableComments").append("<tr><td>" + response[i].label + "</td><td>" + response[i].comment + "</td><td>" + response[i].userName + "</td><td>" + response[i].time + "</td></tr>");
                                  }
                              }
                          }

                      }


    if ($("#fieldhistorytable").find("tr").length <= 1) {
    $("#pageThirdLast").css({ "min-height": "0px", "height": "0px", "overflow": "hidden"});
    $("#thumbnailThirdLast").hide();
    } else {
    $("#thumbnailThirdLast").show();
    $("#pageThirdLast").show();
    }

    if ($("#fieldhistorytableComments").find("tr").length <= 1) {
    $("#pageSecondLast").css({"min-height":"0px","height":"0px","overflow": "hidden"});
    $("#thumbnailSecondLast").hide();
    } else {
    $("#pageSecondLast").show();
    $("#thumbnailSecondLast").show();
    }

    },
    error: function (error) {
    toastr.error("@Resources_Messages.Error_ErrorLoadingData.");
    }
    });
    }

    function rcsaprocessname() {
    $("#processUrl").parent().hide();

    if (gm.actioncentre.selectedRow().workflowCategory() == null) {
    return false;
    }

    if (gm.actioncentre.selectedRow().workflowCategory().trim() == "RCSAW" || gm.actioncentre.selectedRow().workflowCategory().trim() == "CRSA") {
    $("#processUrl").parent().hide();


    var processListUrl = "Workflow/GetRCSAProcessList";

    $.ajax({
    type: "GET",
    cache: false,
    url: processListUrl,
    contentType: 'application/json',
    success: function (response) {

    if (response) {

    var data = $.map(response,
    function (obj) {
    obj.id = obj.id || obj.value; // replace pk with your identifier
    obj.text = obj.text || obj.label; // replace name with the property used for the text
    return obj;
    });
    data.push({ value: gm.actioncentre.selectedRow().processId(), label: gm.actioncentre.selectedRow().processName(), id: gm.actioncentre.selectedRow().processId(), text: gm.actioncentre.selectedRow().processName() });


    data.push({ value: " ", label: " ", id: " ", text: " " });
    // $('#referencecListRCSA').empty();
    $('#referencecListRCSA').select2({ data: data, theme: 'material' });

    if ((gm.actioncentre.selectedRow().processId() != null) && (gm.actioncentre.selectedRow().processId() != " "))
    {

    if (target === "#Inprogress") {
    $("#referencecListRCSA").prop('disabled', true);
    }
    if (target === "#Completed") {
    $("#referencecListRCSA").prop('disabled', true);
    }
    $('#referencecListRCSA').val(gm.actioncentre.selectedRow().processId());
    $('#referencecListRCSA').trigger("change");
    //$('#referencecListRCSA').select2("val", gm.actioncentre.selectedRow().processId());
    } else {
    $('#referencecListRCSA').select2("val", " ");
    }

    $("#referencecListRCSA").change(function () {
    $("#processurlReadonly").hide();
    if ($('#referencecListRCSA').val() != " ") {

    setImageUrl($('#referencecListRCSA').val());

    }
    });


    //$("#referencecListRCSA").val(savedReferenceId).change();
    }
    },
    error: function (error) {
    toastr.error("@Resources_Messages.Error_ErrorLoadingData");
    }
    });

        } @*else {

    var processListUrl = "User/GetProcessesByUserMembership";

    $.ajax({
    type: "GET",
    cache: false,
    url: processListUrl,
    contentType: 'application/json',
    success: function (response) {
    if (response) {

    var data = $.map(response,
    function (obj) {
    obj.id = obj.id || obj.value; // replace pk with your identifier
    obj.text = obj.text || obj.label; // replace name with the property used for the text
    return obj;
    });

    data.push({ value: gm.actioncentre.selectedRow().processId(), label: gm.actioncentre.selectedRow().processName(), id: gm.actioncentre.selectedRow().processId(), text: gm.actioncentre.selectedRow().processName() });

    // $('#referencecListRCSA').empty();

    data.push({ value: " ", label: " ", id: " ", text: " " });

    $('#referencecListRCSA').select2({ data: data, theme: 'material' });
    $('#referencecListRCSA').attr('disabled', true);

    if ((gm.actioncentre.selectedRow().processId() != null) && (gm.actioncentre.selectedRow().processId() != " ")) {
    $('#referencecListRCSA').select2("val", gm.actioncentre.selectedRow().processId());
    } else {
    $('#referencecListRCSA').select2("val", " ");
    }
    //$("#referencecListRCSA").val(savedReferenceId).change();
    }
    },
    error: function (error) {
    toastr.error("@Resources_Messages.Error_ErrorLoadingData");
    }
    });
    }*@
    }

    function PrintModal() {
    const printDialog = $('#printDialog').modal({ show: false });

    this.hide = function() {
    printDialog.modal('hide');
    };

    this.toggle = function() {
    printDialog.modal('toggle');
    }

    this.print = function() {
    this.hide();
    window.print();
    }











    const container = $('.main-container');

    this.toggleSummary = function() {
    container.toggleClass('hideSummary');
    };

    this.toggleComments = function() {
    container.toggleClass('hideComments');
    };

    this.toggleApproval = function() {
    container.toggleClass('hideApproval');
    };
    }

    const printModal = new PrintModal();

    function printForm() {
    printModal.toggle();
    }
    //#AmendmentHistoryCode to close popup

    function closeAmendmentHistory() {
    $("#amendment_history_popup .history_content a").remove(); // clear data before closing
    $("#amendment_history_popup").hide();
        }

    //#AmendmentHistoryCode to showpopup
    function showAmendmentHistory() {
    var endPointUrl = "@Url.Action("GetAmendmentsHistory", "ActionCentre")?taskId=" + gm.actioncentre.selectedRow().taskId();
    $.ajax({
    url: endPointUrl,
    type: 'GET',
    cache: false,
    async: false,
    dataType: 'json',
    contentType: false,
    processData: false,
    success: function(data) {
    $("#amendment_history_popup").show();
    if (data.length > 0) {
        for (let i = 0; i < data.length; i++) {
            let widthPercentage = data[i].type == "@Resources_Messages.Label_BusinessImpactAnalysis" ? "28%":"33%";
            let biaList = data[i].type == "@Resources_Messages.Label_BusinessImpactAnalysis" ? `<li style=width:16%><b>@Resources_Messages.Label_URN</b></br><span title=${data[i].urn}>${data[i].urn}</span></li>` : ''
            $("#amendment_history_popup .amendment_history_popup_scrollableDiv").append("<a target='_blank' href='ActionCentre/Managev3?taskId=" + data[i].taskId + "'><ul class='history_data'>" + biaList + "<li style=width:" + widthPercentage + ">" + "<b>@Resources_Messages.Label_ReferenceID</b></br><span title=" + data[i].referenceNumber + ">" + data[i].referenceNumber + "</span></li><li style=width:" + widthPercentage + "><b>@Resources_Messages.Label_CreatedBy</b></br><span title="+data[i].createdBy+">" + data[i].createdBy + "</span></li><li style=width:" + widthPercentage +">" +"<b>@Resources_Messages.Label_CreatedDate</b></br><span title="+data[i].createdDate+">" + data[i].createdDate + "</span></li></ul></a>");
    $("#amendment_popup_text").text("@Resources_Messages.Label_SelectVersionToOpen");
    }
    }
    else {
    $("#amendment_popup_text").text("@Resources_Messages.Label_NoAmendmentsFound");
    }
    },
    error: function(error) {
    JL().error(error);
    toastr.error("@Resources_Messages.Error_InternalErrorRequestNotCompleted");
    $("#amendment_history_popup").hide();
    }
    });
        }

        function convertDateFormat(dateString) {
            //To discuss
            //let dateObj = new Date(moment(dateString,"dd-mm-yyyy"));
            let dateObj = new Date(dateString);

            let day = String(dateObj.getDate()).padStart(2, '0');
            let month = String(dateObj.getMonth() + 1).padStart(2, '0');
            let year = dateObj.getFullYear();

            let formattedDate = `${day}/${month}/${year}`;
            return formattedDate;
        }

        function getISTDateTime(utcDateString) {
            // Parse the UTC date string
            let utcDate = new Date(utcDateString);

            // Convert UTC to IST (Asia/Kolkata)
            let options = {
                timeZone: 'Asia/Kolkata', // IST time zone
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: true // 12-hour format with AM/PM
            };

            // Create formatters for date and time
            let dateFormatter = new Intl.DateTimeFormat('en-GB', {
                timeZone: 'Asia/Kolkata',
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            });

            let timeFormatter = new Intl.DateTimeFormat('en-GB', {
                timeZone: 'Asia/Kolkata',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: true
            });

            // Format the date and time
            let formattedDate = dateFormatter.format(utcDate);
            let formattedTime = timeFormatter.format(utcDate);

            // Construct the formatted string
            let formattedIST = `${formattedDate} ${formattedTime}`;

            return formattedIST;
        }

    </script>
}
